\documentclass[10pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{amsmath,amsfonts,amssymb,mathrsfs,amsthm}

\usepackage[hidelinks]{hyperref}

\usepackage{fullpage}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}

\DeclareMathOperator{\supp}{supp}

\title{Long-time error estimates of low-regularity integrators for nonlinear
Schr\"odinger equations}
\date{}
%\author{}

\begin{document}
  \maketitle
  \begin{abstract}
    We investigate the long-time behavior of a resonance-based low-regularity 
    integrator for the cubic nonlinear Schrodinger equation (NLS). Specifically, 
    we analyze the cubic NLS with a weak nonlinearity characterized by a 
    dimensionless parameter \(\varepsilon \in (0,1]\). Through rescaling, this 
    equation is equivalent to the NLS with small initial data. We provide rigorous
    error estimates for rough initial data \(\phi \in H^1\) up to a time of \(O(\varepsilon^{-\alpha})\), 
    where \(\alpha\) can be chosen up to \(4\) in dimension \(1\) and arbitrarily 
    large in dimension \(2\). Notably, in dimension \(3\), we establish uniform 
    estimates in time with the help of scattering theory.
  \end{abstract}

  \section{Introduction}
  We consider the following cubic nonlinear Schr\"{o}dinger equation (NLS)
  \begin{equation}\label{nls-ep-nonl} % nls with epsilon nonlinearity
    \left\{
    \begin{aligned}
      & i\partial_t u = -\Delta u + \varepsilon^2 |u|^2 u, \quad (t,x) \in
      \mathbb R\times\mathbb R^d, \\
      & u|_{t=0} = \phi, \quad x \in \mathbb R^d,
    \end{aligned}
    \right.
  \end{equation}
  in dimension \( d \leq 3 \), where \(\phi\) is a given function, and \(
  \varepsilon \in (0,1] \) is a dimensionless parameter. %to characterize the size of
  %the initial data. 
  Note that, rescaling the amplitude by introducing \(w = \varepsilon u\),
  the original equation~\eqref{nls-ep-nonl} with \(O(\varepsilon^2)\)-nonlinearity and 
  \(O(1)\)-initial data can be reformulated as the following equivelant NLS
  with \(O(1)\)-nonlinearity and \(O(\varepsilon)\)-initial data,
  \begin{equation}%\label{nls-ep-ini} %nls with epsilon initial value
    \left\{
    \begin{aligned}
      & i\partial_t w = -\Delta w + |w|^2 w, \quad (t,x) \in
      \mathbb R\times\mathbb R^d, \\
      & w|_{t=0} = \varepsilon \phi, \quad x \in \mathbb R^d.
    \end{aligned}
    \right.
  \end{equation}

  In recent decades, many numerical methods have been proposed to solve the NLS,
  including finite difference methods, exponential integrators, and time-splitting
  methods, see, e.g.~\cite{BDDLV21,HO10,BDD02,Lub08,Tha12}.
  Most of them require the initial value to have high regularity, i.e. \(\phi
  \in H^r\), \(r>d/2\). For nonsmooth initial data, resonance-based schemes play
  a significant role thanks to discrete Bourgain spaces and discrete Strichartz
  type estimates~\cite{ORS21,ORS22b}. However, the current error analysis is restricted to
  short time scales \(T=O(1)\).
  %including finite difference methods~\cite{BDDLV21}, exponential integrators~\cite{HO10}, and time-splitting
  %methods~\cite{BDD02,Lub08,Tha12}.
  %These citations provide only a limited representation of the extensive research
  %conducted in this field, as there exist numerous other methods and references
  %that cannot be comprehensively listed.
  %However, in these works, we usually ask the initial data and error analysis in
  %high-regularity Sobolev space. More precisely, the typical scheme behaves as
  %follows: convergence in \(H^\sigma\) of order \(n\) for initial value in
  %\(\phi \in H^{\sigma+2n}\) with \(\sigma > d/2\). After that, new classes of
  %schemes requiring less regularity were presented, e.g.~\cite{OS18,OWY22} which
  %proves the convergence in in \(H^\sigma\) of order \(n\) for initial value in
  %\(\phi \in H^{\sigma+n}\) with \(\sigma > d/2\), and~\cite{AB23a} which proves
  %the convergence in in \(H^\sigma\) for for initial value in \(\phi \in
  %H^\alpha\) with \(\sigma < d/2\) and \(\alpha > d/2\). Later, the seminal
  %work~\cite{ORS21} and~\cite{ORS22b} gives the rigorous error analysis on full
  %space and torus for
  %initial data in \(H^\alpha\) with some \(\alpha < d/2\)
  %thanks to resonance-based scheme, discrete Bourgain spaces and discrete Strichartz
  %type estimates. However, the current error analysis of is restricted to
  %short time scales \(T=O(1)\). The error roughly takes the form
  %\(Ce^{CT}\tau^\nu\) of some power \(\nu\), which will grow exponentially
  %over time \(T\).

  On long-time scale, the behavier of various
  numerical schemes for the NLS have been 
  studied~\cite{CCMM15},~\cite{FGP10}, \cite{FGP10b}, \cite{GL10},~\cite{GL10b}. 
  Via a so-called regularity compensation oscillation technique, the 
  error bounds were proved for the time-splitting scheme and a non-resonant
  low-regularity scheme on torus up to time of order \(O(\varepsilon^{-2})\) for cubic
  NLS~\eqref{nls-ep-nonl}~\cite{BCF},~\cite{FMS23}.
  These long time error estimates are, however, up to now restricted to smooth
  Sobolev spaces \(H^r\), \(r>d/2\). 

  Hence, to summarize, low regularity error estimates
  are so far restricted to short time scales \(T=O(1)\), while long time estimates
  require smooth solutions.
  In this work we aim to close this gap by establishing long time error estimates 
  which also allow for rough data \(\phi \in H^1\). We focus on the numerical scheme 
  given in~\cite{ORS21}. The techniques developed for our analysis also hold for 
  other numerical schemes, such as splitting methods or exponential integrators.


  %In this paper, we analyze the long time behavier of the numerical scheme
  %given in~\cite{ORS21}.
  %Our aim is to carry out the long-time error bounds for resonance-based
  %schemes with small initial data.

  In particular, for the asymptotic behavier of the NLS, people have
  done a lot of work in the analytical aspect in the last century, and
  have developped the scattering theory. Recently,
  some of the work have brought these results into the numerical aspect~\cite{CS22}. In our
  work, we use some results of scattering theory, and give a uniform in time
  bound in dimension \(3\).

  \section{Main theorem}

  % TODO: Consider whether to explain how this is approximated
  As presented in~\cite{ORS21}, we choose the following scheme
  \begin{equation}\label{num-sol} %numerical solution
    \left\{
    \begin{aligned}
      & u^{n+1} = \Phi_K^{\tau}(u^n) := e^{i\tau\Delta} \left( u^n -
      i\varepsilon^2 \tau \Pi_K
      \left( {(\Pi_K u^n)}^2 \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^n \right) \right), \\
      & u^0 = \Pi_K \phi,
    \end{aligned}
    \right.
  \end{equation}
  to approximate the solution \(u(t)\) of~\eqref{nls-ep-nonl} at time \( t = t_{n+1} = t_n + \tau \),
  with \( \varphi_1(z) = \frac{e^z-1}{z} \) and the projection operator defined
  by the Fourier multiplier
  \begin{equation}
    \Pi_K = \chi^2 \left( \frac{-i\nabla}{K} \right).
  \end{equation}
  Here \(\chi\) is a smooth radial nonnegative bump function which is one on \(
  B(0,1) \) and supported in \( B(0,2) \), and \( K \geq 1 \) is considered as a
  parameter that will depend on \(\tau\) and \(\varepsilon\). More precisely, we will choose \( K =
  \varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2} \) with some \(\beta \geq 0\) and 
  \(\gamma \geq 1\).  % TODO: explain the reason of choosing beta and gamma

  Denoting \(u^K\) as the exact solution of the filtered PDE,
  \begin{equation}\label{nls-fil} % filtered NLS
    \left\{
    \begin{aligned}
      & i\partial_t u^K = -\Delta u^K + \varepsilon^2 \Pi_K|\Pi_K u^K|^2 \Pi_K u^K \\
      & u^K|_{t=0} = \Pi_K\phi,
    \end{aligned}
    \right.
  \end{equation}
  then we can bounded the total error by the following two parts
  \begin{equation}\label{seperr}
    \| u(t_n) - u^n \|_{L^2} \leq \| u(t_n) - u^K(t_n) \|_{L^2} + 
    \| u^K(t_n) - u^n \|_{L^2}.
  \end{equation}

  %We will see later in Section~\ref{sec:freq-trunc-err} that the first term on
  %the right hand side can only be controlled by \(1/K\). 
  
  \begin{theorem}\label{main}
    For every \( T > 0 \), \( \phi \in H^1 \), donote by \(u\) the exact solution
    of equation~\eqref{nls-ep-nonl} and by \(u^n\) the sequence defined by the 
    scheme~\eqref{num-sol}.
    \begin{itemize}
      \item If \(d=1\), for every \(0 < \alpha \leq 4\), with the choise 
        \(K=1/\varepsilon^\frac{5(4-\alpha)}{18}\tau^\frac56\), there exist \(\tau_0 > 0\) 
        such that for every step size \(\tau \in (0,\tau_0]\), every 
        \( \varepsilon \in (0,1] \), we have 
        \[ \|u(t_n)-u^n\|_{L^2} \lesssim_\alpha \varepsilon^\frac{5(4-\alpha)}{18}\tau^\frac56, \quad 
        0 \leq n\tau\varepsilon^\alpha \leq T. \]
      \item If \(d=2\), for every \(\alpha > 0\), and every \(0 < \eta < 3/4\) with 
        the choise \(K=1/\varepsilon^\eta\tau^\frac34\), there exist \(\tau_0 > 0\) 
        such that for every step size \(\tau \in (0,\tau_0]\), every 
        \( \varepsilon \in (0,1] \), we have
        \[ \|u(t_n)-u^n\|_{L^2} \lesssim_{\alpha,\eta} \varepsilon^\eta \tau^\frac34, \quad 
        0 \leq n\tau\varepsilon^\alpha \leq T. \]
      \item If \(d=3\), with the choise \(K=1/\varepsilon^\frac23\tau^\frac23\), 
        there exist \(\tau_0 > 0\) 
        such that for every step size \(\tau \in (0,\tau_0]\), every 
        \( \varepsilon \in (0,1] \), 
        we have the following uniform in time estimate
        \[ \sup_{n \geq 0} \|u(t_n)-u^n\|_{L^2} \lesssim \varepsilon^\frac23 
        \tau^\frac23|\log\tau+\log\varepsilon|^\frac23. \]
    \end{itemize}
  \end{theorem}

  Note that the convergence rate of \(\tau\) is the same as in~\cite{ORS21}. 
  Particularly in dimension \(3\), in the special case when \(\varepsilon=1\), the
  result above gives the uniform in time error estimates for the cubic
  Schr\"odinger equation, which is an improvement of the result in~\cite{ORS21}.
  At the same time, the convergence rate in dimension \(3\) is better than 
  \(\tau^\frac12\) which given in~\cite{CS22}.

  The rest of this paper is organized as follows. In
  Section~\ref{sec:pre-estim}, we recall some well-known results related to
  cubic NLS and adapt them to the equation~\eqref{nls-ep-nonl} with
  \(\varepsilon^2\) non-linearity. In Section~\ref{sec:freq-trunc-err}, we estimates 
  the first part of~\eqref{seperr}. Section~\ref{sec:DSE-exact-sol}
  provides the crucial estimates of the type \(\|u^K(t_k)\|_{l^p L^q}\) which play an
  important role in the subsequent error estimates. Section~\ref{sec:err-anal}
  gives the error analysis and estimates the local error. Section~\ref{sec:proof-main},
  proves the main Theorem~\ref{main}. Finally, the proofs of  some technical 
  results are presented in the last section.


  \section{Preliminary estimates}\label{sec:pre-estim}

  First of all, let's recall the well known Strichartz estimates. We say that 
  \( (p,q) \) is admissible if \(p \geq 2\), \(q \geq 2\), \((p,q,d) \neq (2,\infty,2)\)
  and \( \frac2p + \frac{d}q = \frac{d}2 \). We denote \(p'\)
  and \(q'\) be the dual of \(p\) and \(q\), i.e., \(\frac1p+\frac1{p'} = 1\) 
  and \(\frac1q+\frac1{q'} = 1\). 

  \begin{theorem}
    For every \((p,q)\) admissible, there exists \(C > 0\) such that for every 
    \( f \in L^2 \) and \( F \in L^{p'} L^{q'} \)
    \begin{eqnarray}
      \label{Tc} & & \|e^{it \Delta} f \|_{L^p{L^q}} \leq C \| f\|_{L^2} \\
      \label{T*c} & & \left \| \int_{\mathbb R} e^{-is \Delta } F(s,\cdot)\, ds\right\|_{L^2} 
      \leq C \|F \|_{L^{p'} L^{q'}}.
    \end{eqnarray}
    Moreover, for every \((p_1, q_1)\) and \((p_2, q_2)\) admissible, there exists
    \(C > 0\) such that for every \(F \in L^{p_2'} L^{q'_2}\), we have
    \begin{equation}\label{TT*c} 
      \left\| \int_{-\infty}^t e^{i ( t-s ) \Delta } F(s,\cdot) \, ds \right\|_{L^{p_{1}} L^{q_{1}}}
      \leq  C \|F \|_{L^{p_{2}'} L^{q'_{2}}}.
    \end{equation}
  \end{theorem}

  These estimates were proven by Strichartz~\cite{Sz77} in a special case and by
  Ginibre and Velo~\cite{GiVl85}. The endpoint \(p=2\) for \(d \geq 3\) was proven by
  Keel and Tao~\cite{KeTa98}.

  We also have the discrete versions of these estimates for the group 
  \begin{equation}\label{SK}
    S_K(t) = e^{it\Delta} \Pi_K = \Pi_K e^{it\Delta}.
  \end{equation}

  \begin{theorem}\label{thmDSEold} % discrete Strichartz estimates
    For every \((p,q)\) admissible with \(p>2\), there exists \(C>0\) such that
    for every \(K\) and \(\tau\) satisfying \(K\tau^\frac12 \geq 1\), all \(
    f \in L^2 \) and all \(F \in l^{p'}_\tau L^{q'}\), we have 
    \begin{eqnarray}
      \label{To} & & \left\| S_{K}(n \tau) f\right\|_{l^p_\tau L^q} \leq C(K\tau^\frac12)^{\frac2p} \|f\|_{L^2} \\
      \label{T*o} & & \left\| \tau\sum_{n \in \mathbb{Z}}  S_K (-n\tau) F_n \right\|_{L^2} \leq C (K\tau^\frac12)^\frac2p \|F\|_{l^{p'}_\tau L^{q'}}.
    \end{eqnarray}
    For every \((p_1, q_1)\) and \((p_2, q_2)\) admissible with \(p_1>2\),
    \(p_2>2\), there exists \(C > 0\) such that for every \(K\) and \(\tau\) 
    satisfying \(K\tau^\frac12 \geq 1\), all \( s \in [-3,3] \) and all 
    \(F \in L^{p_2'} L^{q'_2}\), we have
    \begin{equation}\label{TT*o}
      \left\| \tau \sum_{k = -\infty}^{n-1}  S_K ((n-k+s)\tau) F_k \right\|_{l^{p_1}_\tau L^{q_1}}
      \leq C (K\tau^\frac12)^{ \frac2{p_1} + \frac2{p_2} }  \|F\|_{l^{p_2'}_\tau L^{q_2'}}.
    \end{equation}
  \end{theorem}

  These estimates were established in~\cite{IgZz09} 
  in case \(K=\tau^{-\frac12}\), which is the only choice that ensures estimates 
  without loss. And~\cite{ORS21} gives a proof for arbitrary \(K\) that \(K\tau^\frac12 \geq 1\) 
  in order to optimize the total error. However, for our purposes, this is not enough.

  Note that the discrete Schr\"odinger flow is bounded by the following truncated
  decay estimate for every \(K\geq 1\) and every \(p \in [2,\infty]\)
  \[
    \|S_K(t)f\|_{L^p} \leq C \frac{K^{d(1-\frac2p)}}{1+|t|^{\frac{d}2(1-\frac2p)}} \|f\|_{L^{p'}}.
  \]
  Thus we can extend the class of the admissible exponent pairs to all pairs \((p,q)\)
  such that 
  \begin{equation}\label{weakly-admissible}
    p,q \geq 2 ,\quad \frac2p + \frac{d}q \leq \frac{d}2 \text{ and } p \neq 2 \text{ if
    equality holds.}
  \end{equation}
  When the equality doesn't hold, we can prove the result by just replacing the 
  Hardy-Littlewood-Sobelev inequality in the original proof with Young inequality. 
  Therefore, we have the following generalization.

  \begin{theorem}\label{thmDSE} % discrete Strichartz estimates
    For every exponent pair \((p,q)\) satisfying~\eqref{weakly-admissible}, there exists \(C>0\) such that
    for every \(K\) and \(\tau\) satisfying \(K\tau^\frac12 \geq 1\), all \(
    f \in L^2 \) and all \(F \in l^{p'}_\tau L^{q'}\), we have 
    \begin{eqnarray}
      \label{T} & & \left\| S_{K}(n \tau) f\right\|_{l^p_\tau L^q} \leq C K^{\frac{d}2-\frac{d}q} \tau^\frac1p \|f\|_{L^2} \\
      \label{T*} & & \left\| \tau\sum_{n \in \mathbb{Z}}  S_K (-n\tau) F_n \right\|_{L^2} 
      \leq C K^{\frac{d}2-\frac{d}q} \tau^\frac1p \|F\|_{l^{p'}_\tau L^{q'}}.
    \end{eqnarray}
    For every \((p_1, q_1)\) and \((p_2, q_2)\) satisfying~\eqref{weakly-admissible},
    there exists \(C > 0\) such that for every \(K\) and \(\tau\) 
    satisfying \(K\tau^\frac12 \geq 1\), all \( s \in [-3,3] \) and all 
    \(F \in L^{p_2'} L^{q'_2}\), we have
    \begin{equation}\label{TT*}
      \left\| \tau \sum_{k = -\infty}^{n-1}  S_K ((n-k+s)\tau) F_k \right\|_{l^{p_1}_\tau L^{q_1}}
      \leq C K^{d-\frac{d}{q_1}-\frac{d}{q_2}}\tau^{\frac1{p_1}+\frac1{p_2}} \|F\|_{l^{p_2'}_\tau L^{q_2'}}.
    \end{equation}
  \end{theorem}

  %\begin{corollary}\label{corDSEold}
  %  For every $(p,q)$ admissible with $p>2$, there exists $C>0$ such that for every $0<\tau \leq 1$ and $K = \tau^{-\frac\gamma2}$, $\gamma \geq 1$,  we have
  %  \begin{equation}
  %  \label{Tlossold}
  %  \left\| S_{K}(n \tau) f\right\|_{l^p_{\tau}L^q} \leq C    \|f \|_{H^{ \frac2p(1 - \frac1\gamma) }}\qquad \text{for all \ $f\in H^{ {2 \over p}( 1 - {1 \over \gamma} ) }$}. 
  %  \end{equation}
  %  For every $(p, q)$ admissible with  $p>2$, there exists $C>0$ such that for every  $0<\tau \leq 1$, $K = \tau^{-{\gamma \over 2}}$,  $\gamma \ge 1$  and $s \in [-8,8]$ we have
  %  \begin{equation}
  %  \label{TT*lossold}
  %  \left\| \tau  \sum_{k=-\infty}^{n-1}   S_{K} ((n-k+ s) \tau)  F_{k} \right\|_{l^{p}_{\tau}L^{q} } \leq C   \| F\|_{l^1_\tau  H^{ {2 \over p}( 1 - {1 \over \gamma} ) } }\qquad 
  %  \text{for all \ $F\in l^1_\tau  H^{ {2 \over p}( 1 - {1 \over \gamma} ) }$}. 
  %  \end{equation}
  %\end{corollary}
  %Note that, since $\tau^{1 \over p}\| \Pi_{K} f\|_{L^q} \leq  \left\| S_{K}(n \tau) f\right\|_{l^p_{\tau}L^q}$ 
  %the estimate \eqref{Tloss} also encodes the modified Sobolev estimate
  %\begin{equation}
  %  \label{sobmodold}
  %  \tau^{1 \over p} \| \Pi_{K} f\|_{L^q} \leq C \|f \|_{H^{ {2 \over p}( 1 - {1 \over \gamma} ) }}.
  %\end{equation}

  %Indeed, we can generalize the above two theorem, and have the following, for
  %\(K = \varepsilon^{-\beta\gamma} \tau^{-\frac\gamma2}\). And for all exponent
  %pairs \((p,q)\) with \( \frac2p + \frac{d}q \leq \frac{d}2\) if \(p\neq2\) and
  %\( \frac2p + \frac{d}q < \frac{d}2\) if \(p=2\). We call such a pair weakly
  %admissible.

  In this paper, we choose \(K=\varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\),
  \(\beta\geq0\), and \(\gamma \geq 1\), which is a choice in order to optimize
  the total error. It will be useful to convert the estimates of the previous
  theorem into the estimates uniformly bounded with respect to \(\tau\), but
  with loss of derivatives. Hence, we generalize Corollary \(4.3\)
  in~\cite{ORS21}.

  \begin{corollary}\label{corDSE}
    For every \((p,q)\) satisfying~\eqref{weakly-admissible}, assume that in addition
    \(q\neq \infty\), there exists \(C>0\) such that 
    for every \(0<\tau \leq 1\), \( 0 < \varepsilon \leq 1 \) and 
    \(K = \varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\), \(\gamma \geq 1\), 
    \(\beta \geq 0\), and every \(f \in H^{\frac{d}2-\frac{d}q-\frac2{p\gamma}}\), we have
    \begin{equation}
    \label{Tloss}
      \left\| S_K (n\tau) f\right\|_{l^p_\tau L^q} \leq C \varepsilon^{-\frac{2\beta}p} 
      \|f \|_{H^{\frac{d}2-\frac{d}q-\frac2{p\gamma}}}. 
    \end{equation}
    For every \((p_1, q_1)\) and \((p_2, q_2)\) satisfying~\eqref{weakly-admissible}, 
    and \(q_1, q_2 \neq \infty\),
    there exists \(C>0\) such that for 
    for every \(0<\tau \leq 1\), \( 0 < \varepsilon \leq 1 \) and 
    \(K = \varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\), \(\gamma \geq 1\), 
    \(\beta \geq 0\), \(s \in [-3,3]\), and every \(F \in 
    B^{\sigma}_{q_2',2}\)
    we have,
    \begin{equation}
    \label{TT*losscomplicate}
      \left\| \tau \sum_{k=-\infty}^{n-1} S_K ((n-k+s)\tau) F_k \right\|_{l^p_\tau L^q} 
      \leq C \varepsilon^{-\beta(\frac2{p_1}+\frac2{p_2})} \|F\|_{l^{p_2}_\tau 
      B^{\sigma}_{q_2',2}},
    \end{equation}
    where \(\sigma=d-\frac{d}{q_1}-\frac{d}{q_2}-\frac2{\gamma}(\frac1{p_1}+\frac1{p_2})\)
    and we use \(B^s_{p,q}\) to denote the classical Besov space.
  \end{corollary}
  Note that, since \(\tau^\frac1p\| \Pi_{K} f\|_{L^q} \leq  \left\| S_{K}(n \tau) f\right\|_{l^p_{\tau}L^q}\) 
  the estimate~\eqref{Tloss} also encodes the modified Sobolev estimate
  \begin{equation}
    \label{sobmod}
    \tau^\frac1p \|\Pi_K f\|_{L^q} \leq \varepsilon^{-\frac{2\beta}p} 
    \|f \|_{H^{\frac{d}2-\frac{d}q-\frac2{p\gamma}}}.
  \end{equation}
  %Let \(W^{s,p}\) denote the fractional Sobolev space, with the norm
  %\(\|f\|_{W^{s,p}} := \|\langle\nabla\rangle^s f\|_{L^p}\). 
  When \(\sigma\) is 
  not an integer then we can use norm equivelance between \(W^{\sigma,q_2'}\) and 
  \(B^\sigma_{q_2',q_2'}\) and \(q_2' \leq 2\) to
  simplify~\eqref{TT*losscomplicate} as 
  \begin{equation}\label{TT*loss}
    \left\| \tau \sum_{k=-\infty}^{n-1} S_K ((n-k+s)\tau) F_k \right\|_{l^p_\tau L^q} 
    \leq C \varepsilon^{-\beta(\frac2{p_1}+\frac2{p_2})} \|F\|_{l^{p_2}_\tau 
    W^{\sigma,q_2'}}.
  \end{equation}
  %where \(\sigma\) defined as above.

  
  Next, let's recall the conservation laws. We have mass and energy conservation
  for \(u\), and similarly, for \(u^K\) we can also easily get the convervation
  of mass \(M[u(t)] = \int_{\mathbb R^d} |u^K(t,x)|^2 \,\mathrm{d}x\) and of energy
  \(H[u(t)] = \int_{\mathbb R^d} \frac12|\nabla u^K(t,x)|^2 + \frac{\varepsilon^2}2 |\Pi_K u(t,x)|^4\). 
  Then by just relaxing \(\varepsilon\) to \(1\), we can get the following
  \begin{proposition}
    Let \(\phi \in H^1\), \( d \leq 3 \) and \( (p,q) \) admissible with
    \( p > 2 \). Let \( u \) be the solution of~\eqref{nls-ep-nonl} and \(u^K\)
    be the solution of~\eqref{nls-fil}. We have the estimates uniformly in
    \(\varepsilon\)
    \begin{equation}\label{LinftyH1}
      \|u\|_{L^\infty H^1} \lesssim 1 ,\quad
      \|u^K\|_{L^\infty H^1} \lesssim 1.
    \end{equation}
  \end{proposition}

  In dimension \(3\), we have the scattering theory of \(H^1\) scattering for
  \(H^1\) initial data. Let's first recall some intermediate results in
  scattering theory that we will use later. 
  %Let us denote  \(S^0(I\times\mathbb R^d)\)
  %as the Strchartz space which defined as the closure of the Schwartz function
  %under the norm
  %\[ \|u\|_{S^0(I\times\mathbb R^d)} := \sup_{(p,q) \text{admissible}}
  %\|u\|_{L^p L^q(I\times\mathbb R^d)},\]
  %and its dual \(N^0(I\times\mathbb R^d):= {S^0(I\times\mathbb R^d)}^{\star}\), and
  %we use \(S^1(I\times\mathbb R^d)\) and \(N^1(I\times\mathbb R^d)\) for the
  %norms
  %\[ \|u\|_{S^1(I\times\mathbb R^d)} :=\|u\|_{S^0(I\times\mathbb R^d)} + \|\nabla u\|_{S^0(I\times\mathbb R^d)} \]
  %and 
  %\[ \|u\|_{N^1(I\times\mathbb R^d)} :=\|u\|_{N^0(I\times\mathbb R^d)} + \|\nabla u\|_{N^0(I\times\mathbb R^d)} \]
  
  Assume that \(v\) satisfies the usual cubic Schr\"odinger equation without 
  \(O(\varepsilon^2)\) nonlinearity
  \begin{equation}\label{nls}
    i\partial_t v = -\Delta v + |v|^2 v.
  \end{equation}
  Interation Morawetz estimate says that we have the estimate 
  \[ \int_{t_0}^{t_1}\int_{\mathbb R^3} |v(t,x)|^4\,\mathrm{d}x\mathrm{d}t
  \lesssim \sup_{t=t_0,t_1} \|v(t)\|^2_{L^2}\|v(t)\|^2_{\dot{H}^\frac12}.\]
  Then by using this estimate one can get the bound for every \((p,q)\)
  admissible,
  \[ \|v\|_{L^p(\mathbb R,W^{1,q})} \lesssim_{\|v_0\|_{H^1}} 1,\]
  which easily yields the scattering in \(H^1\).
  % TODO: show that it is a simplified proof.

  Now for our purpose, one can easily get similar estimates that hold uniformly in
  \(\varepsilon\) for \(u\) satisfying~\eqref{nls-ep-nonl} and
  \(u^K\) satisfying~\eqref{nls-fil}. 
  % TODO: by either following the proof step by step 
  %or by pluging w into the above estimates and then rescaling to get estimates
  %of u. 
  \begin{proposition}\label{S1}
    Let \(\phi \in H^1\), \( d = 3 \). Let \( u \) be the solution 
    of~\eqref{nls-ep-nonl}. We have the estimates for every \((p,q)\) admissible 
    uniformly in \(\varepsilon\)
    \begin{equation}
      \begin{aligned}
        & \int_{(x,t)\in\mathbb R^3\times\mathbb R} |u(t,x)|^4\,\mathrm{d}x\mathrm{d}t
        < +\infty \\ 
        & \|u\|_{L^p(\mathbb R,W^{1,q})} \lesssim_{\|\phi\|_{H^1}} 1.
      \end{aligned}
    \end{equation}
    Let \(u^K\) be the solution of~\eqref{nls-fil}, then we can get the similar
    estimates as above by replacing \(u\) by \(u^K\).
  \end{proposition}

  For numerical purpose, it's hard to get the discrete version of
  interaction Morawetz estimate. Fortunately, due to Ginibre and
  Velo~\cite{GiVl85b} we have the following decay estimate which can be used to
  get the scattering on the numerical side. 
  \begin{theorem}
    Let \(\phi \in H^1\), \( d = 3 \). For every \(v\in C(\mathbb R,H^1(\mathbb
    R^3))\) the solution of~\eqref{nls}. Then \(v\) satisfies 
    \[ \|v(t)\|_{L^r} \underset{t \to \infty}{\longrightarrow} 0, \]
    for every \(2 < r < 6\).
  \end{theorem}

  \begin{corollary}\label{cordecayestimate}
    Let \(\phi \in H^1\), \( d = 3 \), \(u^K\) be the solution of~\eqref{nls-fil}.
    Then for every \(\eta>0\), \(\varepsilon^\eta \|u^K(t)\|_{L^r}\) tends to \(0\) uniformly in
    \(\varepsilon\) as \(t \to \infty \) for every \( 2 < r < 6\). 
  \end{corollary}

  \begin{proof}
    By passing the result of the previous theorem to \(u^K\), we have that for every fixed \(\varepsilon\),
    \(\|u^K(t)\|_{L^r}\) tends to \(0\) at infinity. We consider the map 
    \[
    \begin{array}{rcl}
      f: (0,1] \times \mathbb R_+ &\rightarrow& H^1 \subset L^r \\
    (\varepsilon,t) &\mapsto& u^K(t).
    \end{array}
    \]
    By using Strichartz estimates, \(f\) is continuous. Indeed, we know
    that the map is continuous with respect to \(t\) for every fixed \(\varepsilon\) 
    and Lipschitz continuous with respect to \(\varepsilon\) for every fixed \(t\), 
    and the Lipschitz coefficient depends on \(\|u(t)\|_{H^1}\), hence uniformly
    bounded in some neighbourhood of \(t\). Hence it's continuous with respect to \((\varepsilon,t)\).

    Therefore, for every \(0 < \varepsilon_0 < 1\), \(\varepsilon^\eta\|u^K(t)\|_{L^r}\) tends 
    to \(0\) at \(\infty\) uniformly in
    \(\varepsilon\) for \(\varepsilon \in (\varepsilon_0,1]\). On the other hands,
    for any \(\delta > 0\), there exist a small \(\varepsilon_0\) such that for
    every \(\varepsilon \in (0,\varepsilon_0)\), \(\varepsilon^\eta \|u\|_{L^r}
    \leq C \varepsilon^\eta \|u\|_{H^1} \leq \delta\). We therefore conclude
    that \(\sup_{\varepsilon \in (0,1]} \varepsilon^\eta\|u^K(t)\|_{L^r} \to 0\) at \(\infty\).
  \end{proof}
  \section{Frequency truncation error}\label{sec:freq-trunc-err}

  In this section, we analysis the first part of the error in~\eqref{seperr}, which
  is \(\|u(t)-u^K(t)\|_{L^2}\). First, by using Duhamel's formula, we have
  that for every interval \(I = [t_1 , t_2]\),
  \begin{multline}
    u(t_2) - u^K(t_2) = e^{it\Delta}(u(t_1) - u^K(t_1))  
    - i \varepsilon^2 \int_{t_1}^{t_2} e^{i(t-s)\Delta} \Pi_K (|u|^2u 
    - |\Pi_K u|^2\Pi_K u) \,\mathrm{d}s \\ 
    - i \varepsilon^2 \int_{t_1}^{t_2} e^{i(t-s)\Delta} \Pi_K (|\Pi_K u|^2\Pi_K u 
    - |\Pi_K u^K|^2\Pi_K u^K) \,\mathrm{d}s  
    - i \varepsilon^2 \int_{t_1}^{t_2} e^{i(t-s)\Delta} (1 - \Pi_K)(|u|^2u) 
    \,\mathrm{d}s .
  \end{multline}
  We then obtain that
  \begin{multline}
    \|u-u^K\|_{L^{\infty}_{I}L^2} - \|(u-u^K)(t_1)\|_{L^2} \lesssim
    \varepsilon^2 \| u - \Pi_K u \|_{L^{\infty}_{I}L^2} ( \|u\|^2_{L^2_{I}L^{\infty}} + 
    \|u^K\|^2_{L^2_{I}L^{\infty}} ) \\
    + \varepsilon^2 \| u - u^K \|_{L^{\infty}_{I}L^2} ( \|u\|^2_{L^2_{I}L^{\infty}} + 
    \|u^K\|^2_{L^2_{I}L^{\infty}} ) + \varepsilon^2 \| u - \Pi_K u \|_{L^{\infty}_{I}L^2} 
    \|u\|^2_{L^2_{I}L^{\infty}}.
  \end{multline}
  By using~\eqref{LinftyH1}, we have 
  \[ \|u-\Pi_K u\|_{L^\infty L^2} \lesssim \frac1K \|u\|_{L^\infty H^1} \lesssim
  \frac1K. \]
  Consequently, we obtain that 
  \begin{multline}\label{u-uKLinftyL2}
    \|u-u^K\|_{L^\infty_I L^2} - \|(u-u^K)(t_1)\|_{L^2} \leq C
    \varepsilon^2 \frac1K (\|u\|^2_{L^2_I L^\infty} + 
    \|u^K\|^2_{L^2_I L^\infty} ) \\
    + C \varepsilon^2 \| u - u^K \|_{L^\infty_I L^2} ( \|u\|^2_{L^2_I L^\infty} + 
    \|u^K\|^2_{L^2_I L^\infty} ).
  \end{multline}


  \begin{proposition}\label{u-uKLinftyL2d3}
    For \(d=3\), we have the estimate uniformly in \(\varepsilon\),
    \begin{equation}
      \|u-u^K\|_{L^\infty({\mathbb R_+},L^2)} \lesssim \frac1K.
    \end{equation}
  \end{proposition}

  \begin{proof}
    Using Proposition~\ref{S1} and Sobolev embedding, we have that 
    \[ \|u\|_{L^2L^\infty}+\|u^K\|_{L^2L^\infty} \lesssim \|u\|_{L^2W^{1,6}} +
    \|u\|_{L^2W^{1,6}} < +\infty \]
    uniformly in \(\varepsilon\). Thus we can divide \(\mathbb R_+\) into finite 
    intervals such that on each interval \(I\), \(C (\|u\|_{L^2_I L^\infty} + 
    \|u^K\|_{L^2_I L^\infty}) \leq \frac12\), where \(C\) is the constant
    in~\eqref{u-uKLinftyL2}, then by~\eqref{u-uKLinftyL2}, we
    have that 
    \[ \|u-u^K\|_{L^\infty_I L^2} \leq 2\|(u-u^K)(t_1)\|_{L^2} + \frac1K. \]
    Therefore, we conclude that 
    \[ \|u-u^K\|_{L^\infty({\mathbb R_+},L^2)} \lesssim \frac1K. \]
  \end{proof}

  %For \(d=1,2\), every admissible pair \((p,q)\) satisfies \(p>2\), and we do not
  %have scattering. 

  \begin{proposition}
    Let \(\phi\in H^1\), \(d=1,2\) and \((p,q)\) admissible. Let \(u\) and \(u^K\) be the solution 
    of~\eqref{nls-ep-nonl} and~\eqref{nls-fil}. Then for every \(\alpha>0\) (\(\alpha
    \leq 4\) if \(d=1\)), for every \(T>0\) there exists a constant \(C_T\) such that for every
    time interval \(I\) satisfying \(\varepsilon^\alpha|I|<T\)
    \[ \|u\|_{L^p_I W^{1,q}} + \|u^K\|_{L^p_I W^{1,q}} \leq C_T. \]
  \end{proposition}

  \begin{proof}
    Just recall the well-known fixed point argument. Let \(X_I=\cap_i L^{p_i} W^{1,q_i}\) 
    be the intersection of finite number of \(L^{p_i} W^{1,q_i}\), where these \((p_i,q_i)\) are 
    well-chosen admissible pairs, including the \((p,q)\) given, a \((p_1,q_1)\)
    that will be determined later, and \((\infty,2)\). We consider 
    \(\Phi_I: X_I \to X_I\) 
    defined by
    \[ \Phi_I(u) = e^{it\Delta} u(t_1) - i\varepsilon^2 \int_{t_1}^{t_2} e^{i(t-s)\Delta}
    f(s)\,\mathrm{d}s, \quad f(s)=|u(s)|^2u(s). \]
    Then by Strichartz estimates we have
    \begin{equation}
      \begin{aligned}
        & \|\Phi_I(u)\|_{X_I} \lesssim \|u(t_1)\|_{H^1} + \varepsilon^2
        T^\theta \|u\|_{X_I}^3 \\
        & \|\Phi_I(u)-\Phi(v)\|_{X_I} \lesssim \varepsilon^2
        T^\theta \|u-v\|_{X_I} (\|u\|_{X_I}^2 + \|v\|_{X_I}^2) 
      \end{aligned}
    \end{equation}
    for some \(\theta\). One can check by calculting the exponent and indices of
    H\"older's inequality that we can take
    \(\theta=\frac12\) for \(d=1\) and \(\theta>0\) arbitrarily small for \(d=2\),
    if we choose the pair \((p_1,q_1)\) carefully.
    Then by the standard fix point argument, there exist a sufficiently small
    \(\delta>0\) such that 
    \[ \|u\|_{X_I} + \|u^K\|_{X_I} \leq C \]
    for all \(I\) satisfying \(\varepsilon^\alpha|I|<\delta\). Finally, we can
    conclude by iterating these arguments. It's similar for \(u^K\).
  \end{proof}

  With the above estimate, we can give a bound for \(\|u-u^K\|_{L^2}\) uniformly
  in \(\varepsilon\) up to time \(O(\varepsilon^{-\alpha})\).

  \begin{proposition}\label{u-uKLinftyL2d12}
    For \(d=1,2\), for every \(T>0\) and every \(\alpha>0\) (\(\alpha \leq 4\) if \(d=1\)) 
    we have 
    \begin{equation}
      \|u-u^K\|_{L^\infty_{T/\varepsilon^\alpha}L^2} \lesssim \frac1K.
    \end{equation}
  \end{proposition}

  \begin{proof}
    For a fixed \(\alpha\), there exist exactly an admissible pair \((p,q)\) such 
    that \(\frac1\alpha = \frac12 - \frac1p\). We have then by H\"older's 
    inequality, Sobolev embedding and the previous proposition 
    \begin{equation}\label{uL2Linfty}
      \varepsilon (\|u\|_{L^2_I L^\infty} + \|u^K\|_{L^2_I L^\infty}) = 
      \varepsilon |I|^{\frac12-\frac1p} (\|u\|_{L^p_I L^q} + \|u^K\|_{L^p_I L^q}) 
      \leq T_1^{\frac1\alpha} C_T
    \end{equation}
    for every time interval \(I\) satisfying \(\varepsilon^\alpha |I| <
    T_1 \leq T\).
    Next, we can shrink \(T_1\) if necessary, to ensure that
    \(C\varepsilon^2 (\|u\|_{L^2_I L^\infty}^2 + \|u^K\|_{L^2_I L^\infty}^2)
    \leq \frac12\), where \(C\) is the constant in~\eqref{u-uKLinftyL2}. 
    Then~\eqref{u-uKLinftyL2} yields 
    \[ \|u-u^K\|_{L^\infty_I L^2} \leq 2\|(u-u^K)(t_1)\|_{L^2} + \frac1K, \]
    for every \(I\) satisfying \(\varepsilon^\alpha |I| < T_1\). Then by
    iteration, we conclude that 
    \[ \|u-u^K\|_{L^\infty_{T/\varepsilon^\alpha}L^2} \lesssim \frac1K. \]
  \end{proof}

  \section{Discrete Strichartz estimates for exact solution}\label{sec:DSE-exact-sol}


  \begin{definition}
    Let \(K=\varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\) for some \(\gamma
    \geq 1\). We say that triple \((p,q,\sigma)\) verifies property {\bf (H)}
    if:
    \[ (p,q) \text{ is admissible}, \quad p>2,\quad \sigma q > d, \quad 
    \sigma + \frac2p\left(1-\frac1\gamma\right) \leq 1 .
    \]
  \end{definition}

  \begin{proposition}\label{uKlpLq}
    Let \(K = \varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\) for some
    \(\beta\geq0\) \(\gamma\geq1\), \(\gamma<2\) in dimension \(3\). Furthur let the
    triple \((p,q,\sigma)\) verify property {\bf (H)}.  Then for every \(T > 0\),
    there exists \(C_T\) such that for every \( \tau \in (0,1] \), every \(\varepsilon \in (0,1]\), 
    every \(\hat{s} \in [-2\tau,2\tau] \) and for every integer 
    \(0 \leq m \leq n \), \(n=m+N\), we have the estimate
    \begin{equation}
      \varepsilon^{\frac{2\beta}p} \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^p_{\tau,m,n}W^{\sigma,q}}
      \leq C_T,\quad \text{ if } \varepsilon^\alpha N\tau \leq T,
    \end{equation}
    for every \(\alpha\) satisfying \(\alpha \leq {2(1-\frac{2\beta}p)}/(\frac12-\frac1p)\).
  \end{proposition}

  \begin{proof}[Proof of Proposition~\ref{uKlpLq}]
    Since \(\Pi_{2K} u^K = u^K\), we can use the modified Sobolev
    estimates~\eqref{sobmod} to get 
    \begin{equation}\label{l0usq}
      \varepsilon^{\frac{2\beta}p}\tau^\frac1p \|e^{i\hat s\Delta}u^K(t)\|_{W^{\sigma,q}} = 
      \varepsilon^{\frac{2\beta}p} \tau^\frac1p \|e^{i\hat s\Delta}\langle\nabla\rangle^\sigma u^K\|_{L^q}
      \leq \|u^K(t)\|_{H^{\sigma_1}} \lesssim 1,
    \end{equation}
    where \(\sigma_1 = \sigma + \frac2p(1-\frac1\gamma) \leq 1\). We use
    Duhamel's formula to get that for every integers \(0 \leq m \leq n \), 
    \(n = m + N\), and \(s \in [0, \tau]\), 
    \[ u^K(t_n+s) = e^{i(t_{n-m})\Delta} u^K(t_m+s) - i\varepsilon^2 
    \int_{t_m+s}^{t_n+s} e^{i(t_{n-m}-\tilde{s})\Delta}\Pi_K
    \left(|\Pi_K u^K|^2 \Pi_K u^K\right) (\tilde{s}) \mathrm{d} \tilde{s}. \]
    After applying \(e^{i\hat s\Delta}\), we rewrite it as 
    \begin{equation}\label{Duhamel}
      e^{i\hat s\Delta}u^K(t_n+s) = e^{i(t_{n-m}+\hat{s})\Delta} u^K(t_m+s) - i\varepsilon^2 
      \sum_{k=m}^{n} \int_{-\tau+s}^{s} e^{i(t_{n-k}+\hat{s}-\tilde{s})\Delta}\Pi_K
      \left(|\Pi_K u^K|^2 \Pi_K u^K\right) (t_k+\tilde{s}) \mathrm{d} \tilde{s}.
    \end{equation}
    By Strichartz estimates, H\"older's inequality and Sobolev embedding, we have 
    \begin{equation}\label{ulpWsq1}
      \begin{aligned}
        \varepsilon^{\frac{2\beta}p}\|e^{i\hat s\Delta}u^K(t_k+s)\|_{l^p_{\tau,m,n}W^{\sigma,q}} 
        & \leq C \|u^K(t_m+s)\|_{H^{\sigma_1}} + \frac{C}\tau
        \varepsilon^2 \int_{s-\tau}^s \left\|\left(|\Pi_K u^K|^2 \Pi_K u^K\right) 
        (t_k+\tilde{s})\right\|_{l^1_{\tau,n}H^{\sigma_1}}\,\mathrm{d}\tilde{s} \\
        & \leq C + C \varepsilon^2 \|u^K\|_{L^\infty H^1} \sup_{\tilde{s} \in [s-\tau,s]} 
        \|u^K(t_k+\tilde{s})\|_{l^2_{\tau,m,n}L^\infty}^2  \\
        & \leq C + C \varepsilon^{2(1-\frac{2\beta}p)} (N\tau)^{\frac12-\frac1p}
        \left( \sup_{\tilde{s} \in [s-\tau,s]} \varepsilon^{\frac{2\beta}p}
        \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n}W^{\sigma,q}}\right)^2.
      \end{aligned}
    \end{equation}
    On the right hand side, when \(-\tau \leq \tilde s<0\), we can use modified Sobolev 
    estimate~\eqref{l0usq},
    \begin{equation*}
      \begin{aligned}
        \varepsilon^{\frac{2\beta}p} \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n}W^{\sigma,q}}
        &\leq \varepsilon^{\frac{2\beta}p} \tau^\frac1p \|u^K(t_m+\tilde{s})\|_{W^{\sigma,q}}
        + \varepsilon^{\frac{2\beta}p} \|u^K(t_k+(\tau+\tilde{s}))\|_{l^p_{\tau,m,n-1}W^{\sigma,q}} \\
        &\leq C + \varepsilon^{\frac{2\beta}p} \|u^K(t_k+(\tau+\tilde{s}))\|_{l^p_{\tau,m,n-1}W^{\sigma,q}} \\
        &\leq C + \varepsilon^{\frac{2\beta}p} \sup_{s \in [0,\tau]} \|u^K(t_k+s)\|_{l^p_{\tau,m,n-1}W^{\sigma,q}}.
      \end{aligned}
    \end{equation*}
    Similarly, for \( 0\leq\tilde{s}\leq \tau\), 
    \begin{equation*}
      \begin{aligned}
        \varepsilon^{\frac{2\beta}p} \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n}W^{\sigma,q}}
        &\leq C + \varepsilon^{\frac{2\beta}p} \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n-1}W^{\sigma,q}} \\
        &\leq C + \varepsilon^{\frac{2\beta}p} \sup_{s \in [0,\tau]} \|u^K(t_k+s)\|_{l^p_{\tau,m,n-1}W^{\sigma,q}}.
      \end{aligned}
    \end{equation*}
    Pluging them into~\eqref{ulpWsq1}, we get for every \(\varepsilon^\alpha N \tau \leq
    T_1 \), where \(\alpha = {2(1-\frac{2\beta}p)}/(\frac12-\frac1p)\)
    \begin{equation}\label{ulpWsq2}
      \varepsilon^{\frac{2\beta}p}\sup_{s\in[0,\tau]}\|e^{i\hat s\Delta}u^K(t_k+s)\|_{l^p_{\tau,m,n}W^{\sigma,q}} 
      \leq C + C T_1^{\frac12-\frac1p}
      \left(C + \sup_{\tilde{s} \in [0, \tau]} \varepsilon^{\frac{2\beta}p}
      \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n-1}W^{\sigma,q}}\right)^2.
    \end{equation}
    Then we can conclude by the following elementary observation. 

    \begin{lemma}\label{observation}
      Let \(a>0\) and \(r>0\) be fixed, and assume that \(b>0\). Set
      \(f(x)=a-x+bx^{1+r}\). Then for sufficiently small \(b\), the set 
      \(J = \{x\geq0:f(x)\geq0\}\) is of the form \(J=[0,y]\cup[z,\infty)\) for
      some \(y\) and \(z\). Therefore, if a positive sequence \((x_n)\) satisfies 
      \(x_{n+1} \leq a + b x_n^{1+r}\), and \(x_0=0\), then we can conclude by
      induction that \(x_n\leq y\) for every \(n\).
    \end{lemma}

    By using the observation above, and the estimates~\eqref{ulpWsq2} 
    we can conclude that we can take sufficiently small \(T_1\), for every
    \(\varepsilon^\alpha N\tau \leq T_1\) 
    \[ \varepsilon^{\frac{2\beta}p} \sup_{s\in[0,\tau]} \|u^K(t_k+\tilde{s})\|_{l^p_{\tau,m,n}W^{\sigma,q}} \leq C'.\]
    Then we can iterate the argument \( \lceil T/T_1 \rceil \) times to get
    \[ \varepsilon^{\frac{2\beta}p} \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^p_{\tau,m,n}W^{\sigma,q}}
      \leq C_T,\quad \text{ if } \varepsilon^\alpha N\tau \leq T. \]
  \end{proof}
  
  \begin{corollary}\label{uKl2Linfty}
    Under the same assumptions as in the previous proposition.
    % TODO: 把这句话改掉不要说under the same assumption 
    For every \(T>0\)
    and every \(\alpha > 0\) (\(\alpha\leq4\) in dimension one). If 
    additionally, \(\beta\leq\frac{4-\alpha}2\) in dimension one. There exist
    an \(\eta>0\) such that for every \(0< T_1 \leq T\), we have 
    %for every \(0 < \delta < \delta_0\)
    %and every integers \(0 \leq m \leq n\), \(n = m + N\) such that 
    %\(\varepsilon^\alpha N \tau < \delta\)
    \[ \varepsilon \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C_T T_1^\eta, \quad \text{ for every } \varepsilon^\alpha N \tau \leq T_1. \]
    In particular, we can also have the bound 
    \[ \varepsilon \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C_T', \quad \text{ for every } \varepsilon^\alpha N \tau \leq T. \]
  \end{corollary}

  \begin{proof}
    We obtain by Sobolev embedding, H\"older's inequality and the previous
    proposition that 
    \[ \varepsilon \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty}
    \leq \varepsilon^{1-\frac{2\beta}p} (N\tau)^{\frac12-\frac1p} C_T. \]
    We can check by calculation that for every \(\alpha\) given, there 
    always exists a triple \((p,q,\sigma)\) satisfying the property {\bf (H)}, 
    that ensures \((1-\frac{2\beta}p)/(\frac12-\frac1p) \geq \alpha\). Then the
    conclusion follows.
  \end{proof}
  
  \begin{remark}\label{remuKl2Linfty}
    The above estimate is a little bit rough, and it will be useful to determine 
    in dimension one and two the optimal exponent \(\theta\) depending on \(\alpha\) 
    and \(\beta\)  such that we have
    \[ \varepsilon^\theta \sup_{s\in[0,\tau]} \|e^{i\hat{s}\Delta}u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C_T, \quad \text{ for every } \varepsilon^\alpha N \tau \leq T. \]
    In other words, we want to determine the optimal \(\theta\) such that there
    exist \((p,q,\sigma)\) satisfying property \((H)\), 
    \(2(1-\frac{2\beta}p)/(\frac12-\frac1p) \geq \alpha\) and 
    \((\theta-\frac{2\beta}p)/(\frac12-\frac1p) \geq \alpha\). Then by direct
    calculation, we obtain that \(\theta\geq \frac{2\beta+\alpha}4\) in dimension
    one, and \(\theta > \beta \) in dimension two.
  \end{remark}

  Using Lemma~\ref{varphiLp}, we can get the same estimates of Proposition~\ref{uKlpLq} 
  for \(\varphi_1(-2i\tau\Delta)u^K\). Then, thanks to the same arguments in
  Corollary~\ref{uKl2Linfty}, we get the following

  \begin{corollary}\label{phiuKlpLq}
    Under the same assumptions as previously, there exist
    a \(\eta>0\) such that for every \(0< T_1 \leq T\), we have 
    \[ \varepsilon \sup_{s\in[0,\tau]} \|\varphi_1(-2i\tau\Delta)u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C_T T_1^\eta, \quad \text{ for every } \varepsilon^\alpha N \tau \leq T_1. \]
  \end{corollary}

  Particularly, in dimension 3, we can use scattering theory to give an uniform
  in time bound for \(l^2_\tau L^\infty\) norm. 

  \begin{proposition}\label{uKl2Linftyd3}
    For \(d=3\), there exist \(C>0\) such that for every \(0\leq m\leq n\)
    \[ \varepsilon \sup_{s\in[0,\tau]} \|u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C. \]
  \end{proposition}

  \begin{proof}
    One could check by calculation that there always exist
    \(\sigma,q_1,p_2,q_2\) such that \((p_2,q_2)\) admissible,
    \(2<p_2<+\infty\), \(\sigma q_1>3\),
    \(\sigma_1 = \frac32 - \frac1\gamma \leq 1\), \(\sigma_2 = \sigma + 3 -
    \frac3{q_1}-
    \frac3{q_2} -\frac2\gamma(\frac12 + \frac1{p_2}) < 1\) and \(r= (\frac13 
    - \frac{p_2-1}{q_1})^{-1} < 6 \).
    The proof is similar as the proof of Proposition~\ref{uKlpLq}. First write Duhamel
    formula as~\eqref{Duhamel} but without \(\hat{s}\), then we use the generalized
    discrete Strichartz estimates~\ref{corDSE} for \((2,q_1)\),
    and \((p_2,q_2)\) admissible, \(2 < p_2 < +\infty\). This yields that
    \[ \varepsilon\|u^K(t_k+s)\|_{l^2_{\tau,m,n}W^{\sigma,q_1}} \leq C \varepsilon^{1-\beta} \| u
    \|_{H^{\sigma_1}} + \frac{C}\tau \varepsilon^{3-\beta(1+\frac2{p_2})} \int_{s-\tau}^s \|
    \left(|\Pi_K u^K|^2 \Pi_K u^K\right)(t_k+\tilde{s})\|_{l^{p_2'}_{\tau,m,n} W^{\sigma_2,q_2'}}
    \,\mathrm{d}\tilde{s}, \]
    where \(\sigma_1 \leq 1\) and \(\sigma_2 < 1\). Then by
    H\"older, we have 
    \[ \varepsilon\|u^K(t_k+s)\|_{l^2_{\tau,m,n}W^{\sigma,q_1}} \leq C \|u\|_{H^1}
    + C \varepsilon^{\eta}\sup_{\tilde{s} \in [s-\tau,s]} \left(
    \|u(t_k+\tilde{s})\|_{l^\infty_{m,n} H^1} \|u(t_k+\tilde{s})\|_{l^\infty_{m,n} L^r}^{\frac2{p_2}} 
    \varepsilon \|u(t_k+\tilde{s})\|_{l^2_{\tau,m,n}W^{\sigma,q_1}}^{\frac2{p_2'}}\right), \]
    where \(\eta = 1-\beta(1+\frac1{p_2})+\frac2{p_2}>0\).
    Similar to Proposition~\ref{uKlpLq}, by modified Sobolev estimate, we can
    control the right hand side, for every \(\tilde s \in [-\tau,\tau]\),
    \[ \varepsilon \|u(t_k+\tilde{s})\|_{l^2_{\tau,m,n}W^{\sigma,q_1}}^{\frac2{p_2'}} 
    \leq C + \sup_{s\in[0,\tau]}\varepsilon \|u(t_k+s)\|_{l^2_{\tau,m,n-1}W^{\sigma,q_1}}^{\frac2{p_2'}}. \]
    Hence, we have for every \( M \leq m \leq n\)
    \[ \sup_{s\in[0,\tau]}\varepsilon\|u^K(t_k+s)\|_{l^2_{\tau,m,n}W^{\sigma,q_1}} \leq C 
    + C \left(\varepsilon^\eta \|u\|_{L^\infty([M,+\infty),L^3)}^{\frac2{p_2}} \right)\left(C + 
    \sup_{s\in[0,\tau]}\varepsilon \|u(t_k+s)\|_{l^2_{\tau,m,n-1}W^{\sigma,q_1}}\right)^{\frac2{p_2'}}, \]
    where \(\eta>0\). Hence by using Corollary~\ref{cordecayestimate} and Lemma~\ref{observation},
    we conclude that there exists \(C\) for sufficiently large \(M\), 
    \[ \sup_{s\in[0,\tau]}\varepsilon\|u^K(t_k+s)\|_{l^2_{\tau,m,n}W^{\sigma,q_1}} \leq C \]
    for every \(m,n\) such that \(M\leq m\leq n\). Noticing that Corollary~\ref{uKl2Linfty}
    gives the bound for finite time, we finish the proof by Sobolev embedding.
  \end{proof}

  By combining the previous Proposition and Lemma~\ref{varphiLp}, we have the
  Corollary.
  \begin{corollary}\label{phiuKL2Linftyd3}
    For \(d=3\), there exist \(C>0\) such that for every \(0\leq m\leq n\)
    \[ \varepsilon \sup_{s\in[0,\tau]} \|\varphi_1(-2i\tau\Delta)u^K(t_k+s)\|_{l^2_{\tau,m,n}L^\infty} 
    \leq C. \]
  \end{corollary}
  
  
  Finally, we give the estimates for \(\|\nabla u^K\|_{l^p L^q}\).

  \begin{proposition}\label{DuKlpLq}
    For \(d =1,2\), \(\alpha>0\) (\(\alpha \leq 4\) if \(d=1\)) and every
    admissible \((p,q)\) with \(p>2\).
    Let \(K = \varepsilon^{-\beta\gamma}\tau^{-\frac\gamma2}\) for some
    \(\beta\geq0\), \(\gamma\geq1\) and \(\gamma<2\) in dimension \(3\), \(\beta
    \leq \frac{4-\alpha}2\) in dimension \(1\). 
    For every \(T>0\) there exists \(C_T>0\) such that 
    for every \( \tau \in (0,1] \), every \(\varepsilon \in (0,1]\), 
    every \(s \in [-2\tau,2\tau] \) and for every integers 
    \(0 \leq m \leq n \), \(n=m+N\), we have the estimate
    \begin{equation}
      \sup_{s\in[-2\tau,2\tau]} \left\|e^{is\Delta} u^K(t_k)\right\|_{l^p_{\tau,n,m}W^{1,q}}
       \lesssim C_T (K\tau^\frac12)^\frac2p, \quad \text{ for every }
       \varepsilon^\alpha N\tau < T.
    \end{equation}
    Similarly, for \(d=3\) there exist \(C\) such that 
    \begin{equation}
      \sup_{s\in[-2\tau,2\tau]} \left\|e^{is\Delta} u^K(t_k)\right\|_{l^p_{\tau,n,m}W^{1,q}}
       \lesssim C (K\tau^\frac12)^\frac2p, \quad \text{ for every } 0 \leq m
       \leq n.
    \end{equation}
  \end{proposition}

  \begin{proof}
    By Duhamel's formula, we write
    \begin{equation}
      e^{is\Delta}u_K(t_n) = S_K(n\tau) (e^{is\Delta} u_0) 
      -i\varepsilon^2 \int_{0}^{\tau} \sum_{k=0}^{n-1} S_K(t_{n-k}+s-\tilde{s}) 
      \left(|\Pi_K u^K|^2 \Pi_K u^K\right)(t_k+\tilde{s}) \mathrm{d} \tilde{s}.
    \end{equation}
    We can use Strichartz estimate to get
    %\begin{multline}
      \[ \|e^{is\Delta} u_K(t_n)\|_{l^p_{\tau,N}W^{1,q}} \lesssim
      (K\tau^\frac12)^\frac2p \|\phi\|_{H^1} 
      + \varepsilon^2
      (K\tau^\frac12)^\frac2p \sup_{\tilde{s}\in[0,\tau]}\left\| 
      \left(|\Pi_K u^K|^2 \Pi_K u^K\right)(t_k+\tilde{s}) \right\|_{l^1_{\tau,N}H^1}. \]
    %\end{multline}
    By H\"older's inequality and Corollary~\ref{uKl2Linfty}, the last term is
    bounded by
    \begin{equation*}
      \begin{aligned}
        \varepsilon^2 \sup_{\tilde{s}\in[0,\tau]}\left\| 
        \left(|\Pi_K u^K|^2 \Pi_K u^K\right)(t_k+\tilde{s}) \right\|_{l^1_{\tau,N}H^1} 
        &\leq \|u^K\|_{L^\infty H^1} \left( \varepsilon \sup_{\tilde{s} \in [0,\tau]} 
        \left\|\Pi_K u^K(t_k+\tilde{s})\right\|_{l_{\tau, N}^2
        L^{\infty}}\right)^2\\
        &\leq C_T.
      \end{aligned}
    \end{equation*}
    In dimension three, by Proposition~\ref{uKl2Linftyd3}, the \(C_T\) above can be
    replaced by a constant \(C\).
  \end{proof}

  \section{Error analysis}\label{sec:err-anal}

  % TODO: Consider wheather to write more details of error analysis.
  Following the discussing in~\cite{ORS21}, we set
  \begin{align}
    \label{TOp}& T(u)(\tau,t_n) = \int_0^{\tau} e^{-is\Delta} |u(t_n+s)|^2 u(t_n+s) \mathrm{d} s \\
    \label{T1} & T_1(s, t_n) = -i\varepsilon^2 \left(e^{i s \Delta} \Pi_K u^K\left(t_n\right)\right)^2 e^{-i s \Delta} \Pi_K \bar{T}\left(\Pi_K u^K\right)\left(s, t_n\right) \\
    \label{T2} & T_2(s, t_n) = -2\varepsilon^4 \left(e^{i s \Delta} \Pi_K u^K\left(t_n\right)\right)\left|e^{i s \Delta} \Pi_K T\left(\Pi_K u^K\right)\left(s, t_n\right)\right|^2 \\
    \label{T3} & T_3(s, t_n) = i\varepsilon^6 \left|e^{i s \Delta} \Pi_K T\left(\Pi_K u^K\right)\left(s, t_n\right)\right|^2 e^{i s \Delta} \Pi_K T\left(\Pi_K u^K\right)\left(s, t_n\right) \\
    \label{T4} & T_4(s, t_n) = 2i\varepsilon^2 \left|e^{i s \Delta} \Pi_K u^K\left(t_n\right)\right|^2 e^{i s \Delta} \Pi_K T\left(\Pi_K u^K\right)\left(s, t_n\right) \\
    \label{T5} & T_5(s, t_n) = \varepsilon^4 \left(e^{-i s \Delta} \Pi_K \bar{u}^K\left(t_n\right)\right)\left(e^{i s \Delta} \Pi_K T\left(\Pi_K u^K\right)\left(s, t_n\right)\right)^2 \\
    \label{E1} & E_1(u^K, \tau, t_n) = i \int_0^{\tau} e^{-is\Delta} 
    [T_1 + T_2 + T_3 + T_4 + T_5](s, t_n) \mathrm{d} s.
  \end{align}
  We have the following
  \begin{multline}
    u^K(t_{n+1}) = e^{i\tau\Delta}u^K(t_n) 
    - i\varepsilon^2\tau S_K(\tau) \left( \left(\Pi_K u^K(t_n)\right)^2 
    \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^K(t_n) \right) \\
    + \varepsilon^2 S_K(\tau) \left( E_1(u^K, \tau, t_n) + E_2(u^K, \tau, t_n) 
    \right)
  \end{multline}
  where \(E_2\) is defined by 
  \begin{multline}\label{E2}
    E_2(u^K, \tau, t_n) = -2 \int_0^{\tau} \int_0^s e^{-is_1\Delta} \left[
    \nabla \left(e^{is_1\Delta}\Pi_K u^K(t_n)\right)^2 
    \nabla \left(e^{i(s_1-2s)\Delta}\overline{\Pi_K u^K(t_n)}\right)\right. \\
    \left.+ \left( \nabla e^{is_1\Delta}\Pi_K u^K(t_n) \right)^2 
    \left( e^{i(s_1-2s)\Delta}\overline{\Pi_K u^K(t_n)} \right) 
    \right] \mathrm{d}s_1\mathrm{d}s .
  \end{multline}
  
  Note that we can rewrite our scheme~\eqref{num-sol} in the form 
  \[ 
    u^{n+1} = e^{i\tau\Delta}u^n - i\varepsilon^2\tau S_K(\tau) 
    \left( (\Pi_K u^n)^2 \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^n \right).
  \]
  Let \( e^n = u^K(t_n) - u^n \) donote the error. Then the error satisfies 
  the following 
  \begin{multline}
    e^{n+1} = e^{i\tau\Delta}e^n - i \varepsilon^2 \tau S_K(\tau) \left( 
    \left(\Pi_K u^K(t_n)\right)^2 \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^K(t_n)
    - (\Pi_K u^n)^2 \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^n \right) \\ 
    + \varepsilon^2 S_K(\tau) \left( E_1(u^K, \tau, t_n) + E_2(u^K, \tau, t_n) 
    \right),
  \end{multline}
  with \( e^0 = 0 \). Therefore, we obtain that 
  \begin{equation}
    e^n = -i \varepsilon^2 \tau \sum_{k=1}^{n-1}
    S_K(t_{n-k})G_k + \mathcal F_1^{n} + \mathcal F_1^{n},
  \end{equation}
  where
  \begin{align}
    \label{Gk} G_k = \left(\Pi_K u^K(t_n)\right)^2 \varphi_1(-2i\tau\Delta)\Pi_K 
    \bar{u}^K(t_n) - (\Pi_K u^n)^2 \varphi_1(-2i\tau\Delta)\Pi_K \bar{u}^n \\
    \label{F1F2} \mathcal F^{n}_1 = \varepsilon^2 \sum_{k=0}^{n-1} S_K(t_{n-k}) E_1(u^k, \tau, t_k), \quad
    \mathcal F^{n}_2 = \varepsilon^2 \sum_{k=0}^{n-1} S_K(t_{n-k}) E_2(u^k, \tau, t_k).
  \end{align}
  And we also have 
  \begin{equation}\label{emn}
    e^n = e^m -i \varepsilon^2 \tau \sum_{k=m}^{n-1}
    S_K(t_{n-k})G_k + 
    + \varepsilon^2 \sum_{k=m}^{n-1} S_K(t_{n-k}) E_1(u^k, \tau, t_k)
    + \varepsilon^2 \sum_{k=m}^{n-1} S_K(t_{n-k}) E_2(u^k, \tau, t_k)
  \end{equation}
  
  Next, we analyze the local error \(E_1\) and \(E_2\).

  \begin{lemma}\label{lemE1} %estimates of F_1
    For every \( T > 0 \),
    there exists \(C_T>0\) such that for every \( \tau, \varepsilon
    \in (0,1] \) and every positive integers \(m,n\), \(m \leq n\), \(n=m+N\)
    satisfying \(\varepsilon^\alpha N\tau \leq T\)
    \begin{equation}
      \|E_1(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq C_T \tau^2.
    \end{equation}
    In dimension three, we can have the uniform in time estimate,
    \begin{equation}
      \|E_1(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq C \tau^2 \quad \text{ for
      every } 0 \leq m \leq n.
    \end{equation}
  \end{lemma}

  \begin{proof}
    First of all, we can write
    \begin{equation}\label{F1lplq}
      \|E_1(u^K, \tau, t_k)\|_{l^1_{\tau,m,n}L^2} \leq C \tau \sup_{s \in [0,\tau]}
      \left(\sum_{i=1}^5 \|T_i(t_n,s)\|_{l^1_{\tau,m,n}L^2} \right).
    \end{equation}
    Next by using~\eqref{T1} and Sobolev embedding, we have 
    \begin{equation}
      \begin{aligned}
        \|T_1(t_n,s)\|_{L^2} &\lesssim \varepsilon^2\|e^{is\Delta}u^K\|^2_{L^6} \|e^{is\Delta} T(\Pi_K u^K)(s,t_n)\|_{L^6} \\ 
        &\lesssim \varepsilon^2\|e^{is\Delta}u^K\|^2_{H^1} \|e^{is\Delta} T(\Pi_K u^K)(s,t_n)\|_{H^1} \\ 
        &\lesssim \varepsilon^2\|u^K\|^2_{H^1} \|T(\Pi_K u^K)(s,t_n)\|_{H^1} .\\ 
      \end{aligned}
    \end{equation}
    Next, by using~\eqref{TOp},
    \begin{equation}\label{TH1}
      \begin{aligned}
        & \|T(\Pi_K u^K)(s,t_n)\|_{H^1} \\ & \lesssim 
        \int_0^\tau \left( 
        \left\| |\Pi_K u^K(t_n+\tilde{s})|^2 \nabla\Pi_K u^K(t_n+\tilde{s}) \right\|_{L^2}
        \left\| |\Pi_K u^K(t_n+\tilde{s})|^2 \Pi_K u^K(t_n+\tilde{s}) \right\|_{L^2}
        \right)\,\mathrm{d}\tilde{s} \\ 
        & \lesssim \|u^K\|_{L^\infty H^1} \int_0^\tau
        \|u^K(t_n+\tilde{s})\|_{L^\infty}^2\,\mathrm{d}\tilde{s}.
      \end{aligned}
    \end{equation}
    Hence, 
    \begin{equation}\label{Tl1H1}
      \|T(\Pi_K u^K)(s,t_n)\|_{l^1_{\tau,m,n} H^1} \lesssim \tau \|u^K\|_{L^\infty H^1}
      \sup_{\tilde{s} \in [0,\tau]} \|u^K(t_n+\tilde{s})\|^2_{l^2_{\tau,m,n}L^\infty}.
    \end{equation}
    We thus obtain
    \[ \|T_1(t_n,s)\|_{l^1_{\tau,m,n}L^2} \lesssim \varepsilon^2\|u^K\|_{L^\infty H^1}^2 \|T(\Pi_K u^K)(s,t_n)\|_{l^1_{\tau,m,n} H^1}
    \lesssim \tau \|u^K\|_{L^\infty H^1}^3 \varepsilon^2\sup_{\tilde{s} \in [0,\tau]} 
    \|u^K(t_n+\tilde{s})\|^2_{l^2_{\tau,m,n}L^\infty} .\]
    By using Corollary~\ref{uKl2Linfty}, we finally obtain 
    \begin{equation}\label{T1l1L2}
      \|T_1(t_n,s)\|_{l^1_{\tau,m,n}L^2} \leq \tau C_T.
    \end{equation}
    In a similar way, we obtain that 
    \begin{align*}
      \|T_2(s,t_n)\|_{L^2} & \lesssim  \varepsilon^4 \|e^{is\Delta} u^K(t_n)\|_{L^6}
      \| e^{is\Delta}T(\Pi_K u^K)(s,t_n) \|_{L^6}^2 \\
      &\lesssim \varepsilon^4 \|u^K(t_n)\|_{H^1} \|T(\Pi_K u^K)(s, t_n) \|_{H^1}^2.
    \end{align*}
    Hence, we get 
    \[ \|T_2(s,t_n)\|_{l^1_{\tau,m,n}L^2} \lesssim \|u\|_{L^\infty H^1} \varepsilon^2 
    \|T(\Pi_K u^K)(s,t_n)\|_{l^\infty_{\tau,m,n}H^1} \varepsilon^2 
    \|T(\Pi_K u^K)(s,t_n)\|_{l^1_{\tau,m,n}H^1}.\]
    By using~\eqref{Tl1H1} to estimate \(\varepsilon^2\|T(\Pi_K u^K)(s,t_n)\|_{l^1_{\tau,m,n} H^1}\), we
    only need to estimate the last term. By using again~\eqref{TH1}, we obtain that
    \[ \|T(\Pi_K u^K)(s,t_n)\|_{l^\infty_{\tau,m,n}H^1} \lesssim \int_0^\tau \|u^K(t_{n}+s)\|_{H^1} \|u^K(t_n+ s) \|_{L^\infty}^2\,\mathrm{d}s \lesssim \|u^K\|_{L^\infty_{T}H^1} \|u^K\|_{L^2_{T}L^\infty}^2 \]
    and, therefore by~\eqref{uL2Linfty},
    \begin{equation}\label{TlinftyH1}
      \varepsilon^2\|T(\Pi_k u^k)(s,t_n)\|_{l^\infty_{\tau,m,n}H^1} \leq 
      \varepsilon^2 \|u^K\|_{L^\infty H^1} \|u^k\|_{L^2_{N\tau} L^\infty}^2 
      \leq C_T
    \end{equation}
    for all \(N\) satisfying \( \varepsilon^\alpha N\tau \leq T \).
    We thus finally obtain that 
    \begin{equation}\label{T2l1L2}
      \|T_2(t_n,s)\|_{l^1_{\tau,m,n}L^2} \leq \tau C_T.
    \end{equation}
    Finally, from the same arguments as above, we have that 
    \[ \|T_3(s,t_n)\|_{L^2}  \lesssim \left(\varepsilon^2\|T(\Pi_K u^K)(s, t_n) \|_{H^1}\right)^3 \]
    and thus 
    \[ \|T_3(t_n,s)\|_{l^1_{\tau,m,n}L^2} \lesssim \left(\varepsilon^2 
    \|T(\Pi_K u^K)(s,t_n)\|_{l^\infty_{\tau,m,n}H^1}\right)^2 \varepsilon^2 
    \|T(\Pi_K u^K)(s,t_n)\|_{l^1_{\tau,m,n}H^1}. \]
    Therefore, by using~\eqref{Tl1H1} and~\eqref{TlinftyH1}, we obtain that 
    \begin{equation}\label{T3l1L2}
      \|T_3(t_n,s)\|_{l^1_{\tau,m,n}L^2} \leq \tau C_T.
    \end{equation}
    The term \(T_4\) is estimated in the same way as \(T_1\), the term \(T_5\)
    in the same way as \(T_2\). Finally, by combining~\eqref{F1lplq},~\eqref{T1l1L2},~\eqref{T2l1L2} 
    and~\eqref{T3l1L2}, we obtain that 
    \[
      \|E_1(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq C_T \tau^2.
    \]
    In dimension three, just notice that all the constants \(C_T\) above are
    independent of \(T\).
  \end{proof}


  \begin{lemma}\label{lemE2} %estimates of F_2
    Under the same assumption of the previous lemma, we have  for every \(0 \leq
    m \leq n \), \(n = m+N\) and \(\varepsilon^\alpha N\tau < T\) in dimension one
    and two
    \begin{align}
      &\label{E2d1} \varepsilon^2 \| E_2 \|_{l^1_{\tau,m,n}L^2} \leq C_T
      (K\tau^\frac12)^\frac12 \tau^2 \varepsilon^{\frac{4-\beta-\alpha}2} 
      \quad \text{ if } d=1,\\
      &\label{E2d2} \varepsilon^2 \| E_2 \|_{l^1_{\tau,m,n}L^2} \leq C_T 
      (K\tau^\frac12) \tau^2 \varepsilon^{2-\beta-}
      \quad \text{ if } d=2,\\
      &\label{E2d3} \varepsilon^2 \| E_2 \|_{l^1_{\tau,m,n}L^2} \leq C 
      (K\tau^\frac12)^2 \log{K}^\frac23 \tau^2 \varepsilon^2
      \quad \text{ if } d=3,
    \end{align}
    where \(2-\beta-\) in the estimate of dimension two means that any exponent
    less then \(2-\beta\).
  \end{lemma}

  \begin{proof}
    At first, using the expressions~\eqref{E2}, we rewrite that
    \begin{equation}%\label{1F2n0}
      E_2(u^K,\tau,t_k) = \int_0^\tau \int_0^s e^{-is_1\Delta} G(s,s_1,t_k)\,\mathrm{d}s_1\,\mathrm{d}s
    \end{equation}
    where
    \begin{multline*}
      G(s,s_1,t_k) =  -\nabla\left( e^{is_1\Delta} \Pi_K u^K(t_k) \right)^2 
      \nabla \left( e^{i(s_1-2s)\Delta} \overline{\Pi_K u^K(t_k)} \right) \\
      + \left( \nabla e^{is_1\Delta} \Pi_K u^K(t_k) \right)^2 \left( e^{i(s_1-2s)\Delta} \overline{\Pi_K u(t_k)} \right)
    \end{multline*}
    and we observe that \(s/\tau\), \(s_1/\tau\), \((s_1- 2s)/\tau\) are uniformly
    bounded in \([-2, 1]\) so that we will be able to use~Theorem~\ref{thmDSE}
    and Proposition~\ref{uKlpLq} and~\ref{DuKlpLq}.
    We first estimate
    \begin{equation}%\label{1F2n}
      \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq \tau^2  
      \sup_{0 \leq s_1 \leq s \leq \tau} \|G(s, s_1, t_k)\|_{l^1_{\tau,m,n}L^2}.
    \end{equation}
    We shall then use slightly different arguments depending on the dimension.
    In dimension \(d \leq 2\), we use H\"older's inequality to get
    \begin{multline*}
      \|G(s,s_1,t_k)\|_{L^2} \lesssim  \|\nabla e^{-i(s_1-2s)\Delta}\Pi_{K}u^K(t_k)\|_{L^4} 
      \|\nabla e^{is_1\Delta} \Pi_{K}u^K(t_k)\|_{L^4}
      \|e^{is_1\Delta}\Pi_{K}u^K(t_k)\|_{L^\infty}  \\
      + \|\nabla e^{is_1\Delta}\Pi_{K}u^K(t_k)\|_{L^4}^2 \|e^{-i(s_1-2s)\Delta}\Pi_{K}u^K(t_k)\|_{L^\infty}
    \end{multline*}
    and therefore,
    \begin{equation}\label{F2lpLq}
      \varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq  
      \varepsilon^2 \tau^2
      \left(\sup_{\hat{s} \in [-2\tau,\tau]}  
      \|\nabla e^{i\hat{s}\Delta}\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^4}  \right)^2 
      \sup_{\hat s \in [-2\tau, \tau]} \|e^{i\hat{s}\Delta}\Pi_K u^K(t_k)\|_{l^2_{\tau,m,n}L^\infty}.
    \end{equation}
    Next, we use Remark~\ref{remuKl2Linfty} and obtain 
    \begin{equation}\label{expuKl2Linfty}
      \sup_{\hat s \in [-2\tau, 2\tau]} \|e^{i\hat s\Delta}\Pi_{K} u^K(t_{k})\|_{l^2_{\tau,m,n}L^\infty} 
      \lesssim \varepsilon^{-\theta},
    \end{equation}
    where \(\theta\) is determined in Remark~\ref{remuKl2Linfty}.
    For \(d=1\), using H\"older and Proposition~\ref{DuKlpLq}, we have
    \begin{equation}\label{1Dul4L4}
      \sup_{\hat{s} \in [-2\tau,\tau]} \|\nabla e^{i\hat{s}\Delta}\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^4}
    \leq (N\tau)^\frac18 \sup_{\hat{s} \in [-2\tau,\tau]} \|\nabla e^{i\hat{s}\Delta}\Pi_K u^K(t_k)\|_{l^8_{\tau,m,n}L^4}
    \leq C_T (N\tau)^\frac18 (K\tau^\frac12)^\frac14
    \end{equation}
    while for \(d=2\), since \((4,4)\) is admissible, we get 
    \begin{equation}\label{2Dul4L4}
      \sup_{\hat{s} \in [-2\tau,\tau]} \|\nabla e^{i\hat{s}\Delta}\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^4}
    \leq C_T (K\tau^\frac12)^\frac12.
    \end{equation}
    Consequently, by combining~\eqref{F2lpLq},~\eqref{expuKl2Linfty} and~\eqref{1Dul4L4},
    we get the desired estimate for \(d=1\)
    \[ \|\varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2}\|_{l^p_{\tau,m,n}L^q} 
    \leq C_T (K\tau^\frac12)^\frac12 \tau^2
    \varepsilon^{2-\frac{\beta+\alpha}2}
    \]
    and by combining~\eqref{F2lpLq},~\eqref{expuKl2Linfty} and~\eqref{2Dul4L4},
    we get for \(d=2\)
    \[ \varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2}
    \leq C_T (K\tau^\frac12) \tau^2 \varepsilon^{2-\beta-} . \]
    In dimension \(3\), since \((4,4)\) is not admissible. We use in place the
    estimate 
    \begin{equation}
      \varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq \varepsilon^2 \tau^2
      \left(\sup_{\hat s \in [-2\tau, \tau]} 
      \|\nabla e^{i\hat s\Delta}\Pi_{K}u^K(t_k)\|_{l^\frac83_{\tau,m,n}L^4} \right)^2 
      \sup_{\hat s \in [-2\tau, \tau]} \|e^{i\hat s\Delta }\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^\infty}
    \end{equation}
    and therefore, we get from Proposition~\ref{DuKlpLq} that 
    \[ \varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq C \varepsilon^2 \tau^2
    (K\tau^\frac12)^\frac32 
    \sup_{\hat s \in [-2\tau, \tau]} \|e^{i\hat s\Delta }\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^\infty} .\]
    Here we cannot use anymore Proposition~\ref{uKlpLq} in order to estimate 
    \(\|e^{i \hat s\Delta }\Pi_{K} u^K(t_{k})\|_{l^4_{\tau,m,n}L^\infty}\). We 
    are thus forced to use Sobolev embedding and Proposition~\ref{DuKlpLq}. 
    Thanks to Lemma~\ref{sobbord}, 
    \[ \|e^{i\hat s\Delta }\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}L^\infty} \lesssim 
    (\log K)^\frac23 \|e^{i\hat s\Delta }\Pi_K u^K(t_k)\|_{l^4_{\tau,m,n}W^{1,3}}
    \leq C (\log K)^\frac23 (K\tau^\frac12)^\frac12 .\]
    This finally yields 
    \[ \varepsilon^2 \|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n}L^2} \leq C (K\tau^\frac12)^2 \log{K}^\frac23
    \tau^2 \varepsilon^2.\]
  \end{proof}

  \section{Proof of the main theorem}\label{sec:proof-main}
  In this section, we always assume that \(0\leq m\leq n\), \(n=m+N\) and
  \(\varepsilon^\alpha N\tau \leq T_1 \leq T\). 
  At first, we use Proposition~\ref{u-uKLinftyL2d12} and
  Proposition~\ref{u-uKLinftyL2d3} to write that 
  \[ \| u(t_n) - u^n \|_{L^2} \leq \|u(t_n) - u^K(t_n)\|_{L^2} + \|u^K(t_n) - u^n\|_{L^2}
  \lesssim \frac1K + \|e^n\|_{L^2}, \]
  for every \( 0 \leq \varepsilon^\alpha n\tau \leq T\), if in dimension one and
  two.
  We shall choose the parameter \(K = \varepsilon^{-\beta\gamma} \tau^{-\frac\gamma2}\)
  to get the optimal error. The choice will depend on the dimension. 
  We hope that \(\tau^{-1}(\|E_1\|_{l^1_{\tau,m,n} L^2} + \|E_2\|_{l^2_{\tau,m,n} L^2})\)
  have the same order as \(\frac1K\). Therefore, we choose
  \begin{equation}\label{bg}
    \begin{aligned}
      & \beta = (4-\alpha)/6, \gamma = 5/3 ,\quad \text{if } d=1, \\ 
      & \beta = 1/2-, \gamma = 3/2, \quad \text{if } d=2, \\ 
      & \beta = 1/2, \gamma = 4/3, \quad \text{if } d=3, 
    \end{aligned}
  \end{equation}
  where \(1/2-\) means any \(\beta < 1/2.\) 
  Under this CFL type condition, we get that 
  \begin{equation}\label{F1F2linftyL2}
    \tau^{-1}\|E_1(u^K,\tau,t_k)\|_{l^1_{\tau,m,n} L^2} + 
    \tau^{-1}\|E_2(u^K,\tau,t_k)\|_{l^1_{\tau,m,n} L^2} \leq C_T \delta,
  \end{equation}
  where
  \begin{equation}\label{delta}
    \begin{aligned}
      \delta &= \frac1K = \varepsilon^{\beta\gamma} \tau^{\frac\gamma2}, \quad \text{if } d=1,2\\ 
      \delta &= \varepsilon^{\beta\gamma} \tau^{\frac\gamma2}(|\log\tau|+|\log\varepsilon|)^\frac23,
      \quad \text{if } d=3 .
    \end{aligned}
  \end{equation}

  We define the norm \(S^{\tau,K}_{m,n}\)
  \[ \|f_k\|_{S^{\tau,K}_{m,n}} := \sup_{s \in \{0,-2\tau\}}\sup_{(p,q) \in \{(\infty,2),(8/d,4)\}} 
  (\|S_K(s)f_k\|_{l^p_{\tau,m,n} L^q} / (K\tau^\frac12)^\frac2p). \]

  Note that by substituting \(u^k = u^K(t_k) - e^k \), we can write~\eqref{Gk}
  as 
  \[ G_k = G_k^1 + G_k^2 + G_k^3, \]
  where 
  \begin{equation*}
    \begin{aligned}
      G_k^1 &= 2(\Pi_K u^K(t_k))(\varphi_1(-2i\tau\Delta)\Pi_K\overline u^K(t_k))(\Pi_K e^k)
      + (\Pi_K u^K(t_k))^2\varphi_1(-2i\tau\Delta)\Pi_K\overline e^k, \\
      G_k^2 &= -\left(\varphi_1(-2i\tau\Delta)\Pi_K \overline u^K(t_k)\right)(\Pi_K e^k)^2 
      - 2(\Pi_K u^K(t_k))(\Pi_k e^k)\varphi_1(-2i\tau\Delta)\Pi_K \overline e^k, \\
      G_k^3 &= (\Pi_K e^k)^2\varphi_1(-2i\tau\Delta)\Pi_K\overline e^k.
    \end{aligned}
  \end{equation*}
  To estimates \(e^n\), we use the discrete Strichartz estimates of
  Theorem~\ref{thmDSE} and~\eqref{F1F2linftyL2}, we get that 
  \begin{equation}\label{enlinftyL2}
    \|e^n\|_{S^{\tau,K}_{m,n+1}} \leq C_T \delta + C \varepsilon^2\|G_k^1\|_{l^1_{\tau,m,n}L^2} 
    + C \varepsilon^2\|G_k^2\|_{l^1_{\tau,m,n}L^2} + C (K\tau^\frac12)^\frac d4 
    \varepsilon^2\|G_k^3\|_{l^{(\frac8d)'}_{\tau,m,n}L^\frac43} .
  \end{equation}
  To estimate the \(G^1\), we use that 
  \begin{multline*}
    \varepsilon^2\|G_k^1\|_{l^1_{\tau,m,n}L^2} \lesssim \left(\|e^n\|_{l^\infty_{\tau,m,n}L^2}
    + \|\varphi_1(-2i\tau\Delta)e^n\|_{l^\infty_{\tau,m,n}L^2} \right) \\ \left( 
    \varepsilon^2 \|u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 + 
    \varepsilon^2 \|\varphi_1(-2i\tau\Delta)\Pi_K u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 \right).
  \end{multline*}
  By using Corollary~\ref{uKl2Linfty} and Corollary~\ref{phiuKlpLq}, we can estimate the right
  hand side by 
  \[ \varepsilon^2 \|u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 + \varepsilon^2 
  \|\varphi_1(-2i\tau\Delta)\Pi_K u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 \leq T_1^\eta C_T. \] 
  Combining with Lemma~\ref{varphiLp}, we get that
  \begin{equation}\label{G1}
    \varepsilon^2\|G_k^1\|_{l^1_{\tau,m,n}L^2} \leq T_1^\eta C_T \|e^n\|_{l^\infty_{\tau,m,n}L^2}
    \leq T_1^\eta C_T \|e^n\|_{S^{\tau,K}_{m,n}}.
  \end{equation}
  Let's now estimate \(G_k^2\). From the same argument, we obtain that 
  \begin{multline*}
    \varepsilon^2\|G_k^2\|_{l^1_{\tau,m,n}L^2} \lesssim  \varepsilon
    \left(\|e^n\|^2_{l^4_{\tau,m,n}L^4} + \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^4_{\tau,m,n}L^4} \right) \\
    \left( \varepsilon \|u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty} + 
    \varepsilon \|\varphi_1(-2i\tau\Delta)\Pi_K u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty} \right).
  \end{multline*}
  which yields 
  \[ \varepsilon^2\|G_k^2\|_{l^1_{\tau,m,n}L^2} \leq  C_T \varepsilon
  \left(\|e^n\|^2_{l^4_{\tau,m,n}L^4} + \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^4_{\tau,m,n}L^4} \right).
  \]
  We will estimate the \(l^4L^4\) norm depending on the dimension. Note that the pair 
  \((\frac8d,4)\) is admissible. For \(d=1\), hence by H\"older, we have 
  \begin{equation*}
      \varepsilon \left(\|e^n\|^2_{l^4_{\tau,m,n}L^4} + \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^4_{\tau,m,n}L^4} \right)
      \leq \varepsilon (N\tau)^{\frac14} \left(\|e^n\|^2_{l^8_{\tau,m,n}L^4} 
      + \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^8_{\tau,m,n}L^4} \right).
  \end{equation*}
  For \(d=2\), \((4,4)\) is exactly \((\frac8d,4)\) which is admissible. And for
  \(d=3\), since \((\frac83,4) < 4\) we will use the reverse inclusion rule for
  the discrete \(l^p_\tau\) spaces, which is 
  \[ \|f\|_{l^p_\tau X} \leq \frac1{\tau^{\frac1q-\frac1p}} \|f\|_{l^q_\tau X}, 
  \quad p > q.\]
  Thus 
  \[ \varepsilon \left(\|e^n\|^2_{l^4_{\tau,k}L^4} + \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^4_{\tau,k}L^4} \right)
  \leq \varepsilon \tau^{-\frac14} \left(\|e^n\|^2_{l^\frac8d_{\tau,k}L^4} + 
  \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|^2_{l^\frac8d_{\tau,k}L^4}\right). \]
  Then we use~\eqref{decomp}, we have that 
  \begin{equation*}\label{phie}
    \|\varphi_1(-2i\tau\Delta)\Pi_K e^n\|_{L^4} 
    \lesssim \|S_K(-2\tau)e^n\|_{L^4} + 
    \|e^n\|_{L^4}.
  \end{equation*}
  To summarize, we have 
  \begin{equation*}
    \begin{aligned}
      \varepsilon^2\|G_n^2\|_{l^1_{\tau,k}L^2} &\leq C_T \varepsilon (N\tau)^\frac14 (K\tau^\frac12)^\frac12
      \|e^n\|_{S^{\tau,K}_{m,n}}^2,\quad \text{if }d=1,\\
      \varepsilon^2\|G_n^2\|_{l^1_{\tau,k}L^2} &\leq C_T \varepsilon (K\tau^\frac12)
      \|e^n\|_{S^{\tau,K}_{m,n}}^2,\quad \text{if }d=2,\\
      \varepsilon^2\|G_n^2\|_{l^1_{\tau,k}L^2} &\leq C \varepsilon \tau^{-\frac14} (K\tau^\frac12)^\frac32
      \|e^n\|_{S^{\tau,K}_{m,n}}^2,\quad \text{if }d=3.\\
    \end{aligned}
  \end{equation*}
  By using the definition of \(K\) and \(\delta\) above, we can uniformly write
  the estimate above as 
  \begin{equation}\label{G2}
    \varepsilon^2\|G_n^2\|_{l^1_{\tau,k}L^2} \leq C_T \tau^{\lambda_1}
    \delta^{-1} \|e^n\|_{S^{\tau,K}_{m,n}}^2,
  \end{equation}
  for some \(\lambda_1 > 0\).

  Finally, to estimate the last term of~\eqref{enlinftyL2}, by H\"older
  \[ \|G_n^3\|_{l^{(\frac8d)'}_{\tau,k}L^\frac43} \lesssim \left(
  \left\| \|e^n\|_{L^4}^3 \right\|_{l^{(\frac8d)'}_{\tau,k}} 
  + \left\| \|S_K(-2\tau)e^n \|_{L^4}^3 \right\|_{l^{(\frac8d)'}_{\tau,k}}\right). \]
  For \(d=1\), we obtain by H\"older that 
  \begin{equation*}%\label{G3d1}
    \|G_n^3\|_{l^{(\frac8d)'}_{\tau,k}L^\frac43} \lesssim 
    (N\tau)^\frac12 \left(
    \|e^n\|^3_{l^\frac8d_{\tau,k}L^4} + \|S_K(-2\tau)e^n\|_{l^\frac8d_{\tau,k}L^4}^3\right).
  \end{equation*}
  For \(d=2\), since \((\frac8d)' = \frac13\frac8d\), we obtain again by
  H\"older that 
  \begin{equation*}%\label{G3d2}
    \varepsilon^2 \|G_n^3\|_{l^{(\frac8d)'}_{\tau,k}L^\frac43} \lesssim \varepsilon^2
    \left(\|e^n\|^3_{l^\frac8d_{\tau,k}L^4} + \|S_K(-2\tau)e^n\|_{l^\frac8d_{\tau,k}L^4}^3\right).
  \end{equation*}
  For \(d=3\), since \((\frac8d)' > \frac13\frac8d\), we use again by reverse
  inclusion of \(l^p_\tau\) to get that 
  \begin{equation*}%\label{G3d3}
    \varepsilon^2 \|G_n^3\|_{l^{(\frac8d)'}_{\tau,k}L^\frac43} \lesssim \varepsilon^2 \tau^{-\frac12}
    \left(\|e^n\|^3_{l^\frac8d_{\tau,k}L^4} + \|S_K(-2\tau)e^n\|_{l^\frac8d_{\tau,k}L^4}^3\right).
  \end{equation*}
  To summarize, by calculation, we have 
  \begin{equation}\label{G3}
    (K\tau^\frac12)^\frac d4 
    \varepsilon^2\|G_k^3\|_{l^{(\frac8d)'}_{\tau,m,n}L^\frac43}
    \leq C_T \tau^{\lambda_2} \delta^{-2}
    \|e^n\|_{S^{\tau,K}_{m,n}}^3,
  \end{equation}
  for some strictly positive \(\lambda_2\).

  Finially, plugging~\eqref{G1},~\eqref{G2} and~\eqref{G3} into~\eqref{enlinftyL2}, we conclude that
  in dimension one and two
  \begin{equation}\label{finalestimate}
    \|e^n\|_{S^{\tau,K}_{m,n+1}}/\delta \leq (\|e^m\|_{L^2}/\delta) + C_T + T_1^\eta C_T (\|e^n\|_{S^{\tau,K}_{m,n}}/\delta) + 
    C_T \tau^{\lambda_1} (\|e^n\|_{S^{\tau,K}_{m,n}}/\delta)^2 + 
    C_T \tau^{\lambda_2}(\|e^n\|_{S^{\tau,K}_{m,n}}/\delta)^3.
  \end{equation}
  Consequently, taking \(T_1\) sufficiently small so that \(T_1^\eta C_T \leq
  \frac12 \). Then we can conclude by induction: first let \(m=0\), \(n\) such that
  \(\varepsilon^\alpha n \tau < T_1\), using Lemma~\ref{observation}, we get the
  bound of \(\|e^n\|_{L^2}\) on \([0,T_1/\varepsilon^\alpha]\), then let
  \(m=\lceil T_1/(\varepsilon^\alpha \tau)\rceil\), the first term \(\|e^m\|_{L^2}/\delta\) is
  then bounded by inductive hypothesis. We can iterate the argument and
  finally get 
  \[ \|e^n\|_{S^{\tau,K}_{m,n+1}}/\delta \leq C_T'. \]
  In dimension three, estimate~\eqref{finalestimate} takes the form
  \begin{multline}
    \|e^n\|_{S^{\tau,K}_{m,n+1}}/\delta \leq (\|e^m\|_{L^2}/\delta) + C + 
    C (\varepsilon^2 \|u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 \\ +
    \varepsilon^2 
    \|\varphi_1(-2i\tau\Delta)\Pi_K u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2  ) 
    (\|e^n\|_{S^{\tau,K}_{m,n}}/\delta) \\  + 
    C \tau^{\lambda_1} (\|e^n\|_{S^{\tau,K}_{m,n}}/\delta)^2 + 
    C \tau^{\lambda_2}(\|e^n\|_{S^{\tau,K}_{m,n}}/\delta)^3.
  \end{multline}
  By using Proposition~\ref{uKl2Linftyd3} and Corollary~\ref{phiuKL2Linftyd3}, 
  we can divide \(\mathbb{N}\) into finite parts such that on each part
  \[C (\varepsilon^2 \|u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2 + \varepsilon^2 
  \|\varphi_1(-2i\tau\Delta)\Pi_K u^K(t_n)\|_{l^2_{\tau,m,n}L^\infty}^2) \leq
  \frac12,\] 
  then similarly the conclusion follows by induction.


  \section{Proof of the generalization of discrete Strichartz estimates}
  \begin{proof}[Proof of Theorem~\ref{thmDSE}]
    Since the filtered Schr\"odinger flow satisfies the following truncated
    decay estimates
    \[ \|S_K(t)f\|_{L^p} \lesssim
    \frac{K^{d(1-\frac2p)}}{1+|t|^{\frac{d}2(1-\frac2p)}}\|f\|_{L^{p'}},\]
    we can just imitate the proof in the continuous case by replacing the 
    Hardy-Littlewood-Sobelev inequality by Young inequality.
  \end{proof}

  \begin{proof}[Proof of Corollary~\ref{corDSE}]
    We shall use the Littlewood-Paley theory. Let us recall some facts, we refer
    to the book~\cite{BCD11} for the proof. We take the partition of unity of
    the form 
    \[  \chi(\xi) + \sum_{k\geq0}\varphi(2^{-k}\xi) = 1 ,\]
    where \(\chi\) is supported in the ball \(B(0,1)\) and \(\varphi(2^{-k}\cdot)\) is
    supported in the annulus \(|\xi| \sim 2^k\). We denote the operators 
    \[ \Delta_k u = 0 \text{ if } k \leq -2, \Delta_{-1} u = \chi(\nabla/i) u,
    \text{ and } \Delta_k u = \varphi(2^{-j}\nabla/i) u \text{ if } k \geq 0.\]
    We need to use the fact that for \(1<q<\infty\), the \(L^q\) norm of a function
    \(u\) is equivalent to the norm 
    \[ \left\| \|(\Delta_k u)_{k\in \mathbb Z}\|_{l^2} \right\|_{L^q}. \]
    Using this and Minkowski inequality, then Discrete
    Strichartz estimate, we have
    \begin{equation}
      \begin{aligned}
        \|S_K(n\tau)u\|_{l^p_\tau L^q} & \lesssim \|\|(\Delta_k (S_K(n\tau) u))_{k\in \mathbb Z}\|_{l^2}\|_{l^p_\tau L^q} \\
        &\lesssim \|(\|S_K(n\tau) \Delta_k u\|_{l^p_\tau L^q})_{k\in \mathbb Z}\|_{l^2} \\
        &\lesssim \|((2^k\tau^\frac12)^\frac2p \|\Delta_k u\|_{L^2})_{k\in \mathbb Z, 2^k \lesssim K}\|_{l^2} \\
        &\lesssim \varepsilon^{-\beta\frac2p}\|(2^{k\frac2p(1-\frac1\gamma)} \|\Delta_k u\|_{L^2})_{k\in \mathbb Z}\|_{l^2} \\
        &= \varepsilon^{-\beta\frac2p}\|u\|_{B^{\frac2p(1-\frac1\gamma)}_{2,2}} \\
        &\lesssim
        \varepsilon^{-\beta\frac2p}\|u\|_{H^{\frac2p(1-\frac1\gamma)}}.
      \end{aligned}
    \end{equation}

    The other statements are proved in the same spirit.
  \end{proof}


  \section{Some technical estimates}

  \begin{lemma}\label{lemfilter1}
    We have the following:
    \begin{itemize}
      \item For every \(p \in [1,\infty]\), there exists \(C>0\) such that for every
        \(\tau \in (0,1]\),
        \begin{equation}\label{101}
          \|\varphi_1(-2i\tau\Delta)\Pi_{\tau^{-\frac12}} f\|_{L^p} \leq
          C\|f\|_{L^p} \quad\text{for all } f \in L^p.
        \end{equation}
      \item For every \(p \in (1,\infty)\), there exists \(C>0\) such that for every
        \(\tau \in (0,1]\),
        \begin{equation}\label{102}
          \|\frac{1-\Pi_{\tau^{-\frac12}}}{2i\tau\Delta} f\|_{L^p} \leq
          C\|f\|_{L^p} \quad\text{for all } f \in L^p.
        \end{equation}
      %\item For every \(s \in [0,2]\), there exists \(C>0\) such that for every
      %  \(\tau \in (0,1]\),
      %  \begin{equation}\label{103}
      %    \|\varphi_1(-2i\tau\Delta) f\|_{L^2} \leq
      %    \frac C{\tau^\frac s2}\|f\|_{L^2} \quad\text{for all } f \in L^2.
      %  \end{equation}
    \end{itemize}
  \end{lemma}

  The proof of the above lemma can be found in~\cite{ORS21}.

  \begin{lemma}\label{varphiLp}
    For every \(p \in (1,\infty)\), there exist \(C \geq 0\) such that for every 
    \(\tau \in (0,1]\),
    \begin{equation}\label{decomp}
      \|\varphi_1(-2i\tau\Delta) f\|_{L^p} \leq C \|f\|_{L^p} + C
      \|e^{-2i\tau\Delta}f\|_{L^p}.
    \end{equation}
  \end{lemma}

  \begin{proof}
    By observing the following decomposition 
    \begin{equation}\label{phi1decomp}
      \varphi_1(-2i\tau\Delta) f = \varphi_1(-2i\tau\Delta)\Pi_{\tau^{-\frac12}} f
      - \frac{1 - \Pi_{\tau^{-\frac12}}}{2i\tau\Delta} e^{-2i\tau\Delta} f 
      + \frac{1 - \Pi_{\tau^{-\frac12}}}{2i\tau\Delta} f,
    \end{equation}
    and then using~\eqref{101} and~\eqref{102}, we obtain the assertion.
  \end{proof}

  \begin{lemma}\label{sobbord}
    There exists \(C>0\) such that for every \(u\in W^{1,3}(\mathbb R^3)\) with
    \(\supp \hat{u} \subset B(0,4K)\), \(K \geq 1\), we have
    \[ \|u\|_{L^\infty} \leq C (\log K)^\frac23 \|u\|_{W^{1,3}}. \]
  \end{lemma}

  The proof of this lemma can also be found in~\cite{ORS21}.

  \begin{thebibliography}{99}
    \bibitem{AB23a}
      {\rm Y. Alama Bronsard.}
      {\em Error analysis of a class of semi-discrete schemes for solving the Gross-Pitaevskii equation at low regularity.}
      J. Comput. Appl. Math., 418:Paper No. 114632, 19, (2023).

    \bibitem{BCD11}
      {\rm H. Bahouri, J.-Y. Chemin, R. Danchin.}
      {\em Fourier Analysis and Nonlinear Partial Differential Equations.}
      Springer, Heidelberg, (2011).
    \bibitem{BCF}
      {\rm W. Bao, Y. Cai and Y. Feng.}
      {\em Improved uniform error bounds of the time-splitting methods for the long-time (nonlinear) Schr\"odinger equation.}
      Math. Comp., to appear.

    \bibitem{BDD02}
      {\rm C. Besse, B. Bid\'egaray, S. Descombes.}
      {\em Order estimates in time of splitting methods for the nonlinear Schr\"odinger equation.}
      SIAM J. Numer. Anal. 40(1):26--40 (2002).
      
    \bibitem{BDDLV21}
      {\rm C. Besse, S. Descombes, G. Dujardin, and I. Lacroix-Violet.}
      {\em Energy-preserving methods for nonlinear Schr\"odinger equations.}
      IMA J. Numer. Anal. 41(1):618--653 (2021).
      
    \bibitem{CCMM15}
      {\rm F. Castella, P. Chartier, F. Méhats, A. Murua.}
      {\em Stroboscopic averaging for the nonlinear Schr\"odinger equation.}
      Found. Comput. Math. 15:519--559 (2015).

    \bibitem{CS22}
      {\rm R. Carles, C. Su.}
      {\em Scattering and Uniform in Time Error Estimates for Splitting Method in NLS.}
      Found. Comput. Math. (2022).

    \bibitem{FMS23}
      {\rm Y. Feng, G. Maierhofer, K. Schratz.}
      {\em Long-time error bounds of low-regularity integrators for nonlinear Schrödinger equations.}
      Math. Comp., to appear.

    \bibitem{FGP10}
      {\rm E. Faou, B. Grébert and E. Paturel.} 
      {\em Birkhoff normal form and splitting methods for semilinear Hamiltonian PDEs. Part I: Finite dimensional discretization.}
      Numer. Math. 114:429--458 (2010).

    \bibitem{FGP10b}
      {\rm E. Faou, B. Grébert and E. Paturel.} 
      {\em Birkhoff normal form and splitting methods for semilinear Hamiltonian PDEs. Part II: Abstract splitting.}
      Numer. Math. 114:459--490 (2010).

    \bibitem{GL10}
      {\rm L. Gauckler and C. Lubich.}
      {\em Nonlinear Schr\"odinger equations and their spectral semi-discretizations over long times.}
      Found. Comput. Math. 10:141--169 (2010).

    \bibitem{GL10b}
      {\rm L. Gauckler and C. Lubich.}
      {\em Splitting integrators for nonlinear Schrödinger equations over long times.}
      Found. Comput. Math. 10:275--302 (2010).

    \bibitem{GiVl85}
      {\rm J. Ginibre, G. Velo.}
      {\em The global Cauchy problem for the nonlinear Schr\"odinger equation revisited.}
      Ann. Inst. H. Poincar\'e Anal. Non Lin\'eaire 2:309--327 (1985).

    \bibitem{GiVl85b}
      {\rm J. Ginibre, G. Velo.}
      {\em Scattering Theory in the Energy Space for a Class of Nonlinear Schrodinger Equations.}
      J. Math. Pure Appl. 64:363--401 (1985).

    \bibitem{HO10}
      {\rm M. Hochbruck and A. Ostermann.}
      {\em Exponential integrators.}
      Acta Numerica, 19:209--286 (2010).

    \bibitem{IgZz09}
      {\rm L. Ignat, E. Zuazua.}
      {\em Numerical dispersive schemes for the nonlinear Schr\"odinger equation.}
      SIAM J. Numer. Anal. 47:1366--1390 (2009).

    \bibitem{KeTa98}
      {\rm M. Keel, T. Tao.}
      {\em Endpoint Strichartz estimates.}
      Amer. J. Math. 120:955--980 (1998).

    \bibitem{Lub08}
      {\rm C. Lubich.}
      {\em On splitting methods for Schr\"odinger-poisson and cubic nonlinear Schr\"odinger equations.}
      Mathematics of computation, 77(264):2141--2153, 2008.

    \bibitem{ORS21}
      {\rm A. Ostermann, F. Rousset, K. Schratz.}
      {\em Error estimates of a fourier integrator for the cubic schr\"odinger equation at low regularity.}
      Found. Comput. Math. 21:725--765 (2021).

    \bibitem{ORS22b}
      {\rm A. Ostermann, F. Rousset, K Schratz.}
      {\em Fourier integrator for periodic NLS: low regularity estimates via discrete Bourgain spaces.}
      Journal of the European Mathematical Society, (2022).

    \bibitem{OS18}
      {\rm A. Ostermann, K. Schratz.}
      {\em Low regularity exponential-type integrators for semilinear Schr\"odinger equations.}
      Found. Comput. Math. 18:731--755, (2018).

    \bibitem{OWY22}
      {\rm A. Ostermann, Y. Wu, F. Yao.}
      {\em A second-order low-regularity integrator for the nonlinear Schr\"odinger equation.}
      Adv. Contin. Discrete Models, 23:14, (2022).

    \bibitem{Sz77}
      {\rm R. S. Strichartz.}
      {\em Restrictions of Fourier transforms to quadratic surfaces and decay of solutions of wave equations.}
      Duke Math. J. 44:705--714 (1977).

    \bibitem{Tha12}
      {\rm M. Thalhammer.}
      {\em Convergence analysis of high-order time-splitting pseudospectral methods for nonlinear Schr\"odinger equations.}
      SIAM J. Numer. Anal. 50(6):3231--3258 (2012).

  \end{thebibliography}
\end{document}
